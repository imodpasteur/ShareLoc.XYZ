(function(e){function t(t){for(var a,o,i=t[0],c=t[1],l=t[2],_=0,d=[];_<i.length;_++)o=i[_],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(d.length)d.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,i=1;i<r.length;i++){var c=r[i];0!==n[c]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=r[0]))}return e}var a={},n={app:0},s=[];function o(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=e,o.c=a,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(r,a,function(t){return e[t]}.bind(null,a));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"025e":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"h",(function(){return randId})),__webpack_require__.d(__webpack_exports__,"f",(function(){return fetchFile})),__webpack_require__.d(__webpack_exports__,"k",(function(){return resolveDOI})),__webpack_require__.d(__webpack_exports__,"c",(function(){return dataURLtoFile})),__webpack_require__.d(__webpack_exports__,"j",(function(){return resizeImage})),__webpack_require__.d(__webpack_exports__,"g",(function(){return getFullRdfFromDeposit})),__webpack_require__.d(__webpack_exports__,"e",(function(){return depositionToRdf})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ZenodoClient})),__webpack_require__.d(__webpack_exports__,"d",(function(){return debounce})),__webpack_require__.d(__webpack_exports__,"b",(function(){return concatAndResolveUrl})),__webpack_require__.d(__webpack_exports__,"i",(function(){return replaceAllRelByAbs}));var core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a4d3"),core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_symbol__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("e01a"),core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_symbol_description__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("99af"),core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_array_concat__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("cb29"),core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_array_fill__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4de4"),core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es_array_filter__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("caad"),core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es_array_includes__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("c975"),core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es_array_index_of__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("a15b"),core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es_array_join__WEBPACK_IMPORTED_MODULE_7__),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("d81d"),core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(core_js_modules_es_array_map__WEBPACK_IMPORTED_MODULE_8__),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("fb6a"),core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(core_js_modules_es_array_slice__WEBPACK_IMPORTED_MODULE_9__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("b0c0"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_10__),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("d3b7"),core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_11___default=__webpack_require__.n(core_js_modules_es_object_to_string__WEBPACK_IMPORTED_MODULE_11__),core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("4d63"),core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_12___default=__webpack_require__.n(core_js_modules_es_regexp_constructor__WEBPACK_IMPORTED_MODULE_12__),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("ac1f"),core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(core_js_modules_es_regexp_exec__WEBPACK_IMPORTED_MODULE_13__),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("25f0"),core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_14___default=__webpack_require__.n(core_js_modules_es_regexp_to_string__WEBPACK_IMPORTED_MODULE_14__),core_js_modules_es_string_ends_with__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("8a79"),core_js_modules_es_string_ends_with__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(core_js_modules_es_string_ends_with__WEBPACK_IMPORTED_MODULE_15__),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("2532"),core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(core_js_modules_es_string_includes__WEBPACK_IMPORTED_MODULE_16__),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("3ca3"),core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_17___default=__webpack_require__.n(core_js_modules_es_string_iterator__WEBPACK_IMPORTED_MODULE_17__),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("466d"),core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(core_js_modules_es_string_match__WEBPACK_IMPORTED_MODULE_18__),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("5319"),core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(core_js_modules_es_string_replace__WEBPACK_IMPORTED_MODULE_19__),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("1276"),core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_20___default=__webpack_require__.n(core_js_modules_es_string_split__WEBPACK_IMPORTED_MODULE_20__),core_js_modules_es_string_starts_with__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("2ca0"),core_js_modules_es_string_starts_with__WEBPACK_IMPORTED_MODULE_21___default=__webpack_require__.n(core_js_modules_es_string_starts_with__WEBPACK_IMPORTED_MODULE_21__),core_js_modules_es_typed_array_uint8_array__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("5cc6"),core_js_modules_es_typed_array_uint8_array__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(core_js_modules_es_typed_array_uint8_array__WEBPACK_IMPORTED_MODULE_22__),core_js_modules_es_typed_array_copy_within__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("9a8c"),core_js_modules_es_typed_array_copy_within__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(core_js_modules_es_typed_array_copy_within__WEBPACK_IMPORTED_MODULE_23__),core_js_modules_es_typed_array_every__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("a975"),core_js_modules_es_typed_array_every__WEBPACK_IMPORTED_MODULE_24___default=__webpack_require__.n(core_js_modules_es_typed_array_every__WEBPACK_IMPORTED_MODULE_24__),core_js_modules_es_typed_array_fill__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("735e"),core_js_modules_es_typed_array_fill__WEBPACK_IMPORTED_MODULE_25___default=__webpack_require__.n(core_js_modules_es_typed_array_fill__WEBPACK_IMPORTED_MODULE_25__),core_js_modules_es_typed_array_filter__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("c1ac"),core_js_modules_es_typed_array_filter__WEBPACK_IMPORTED_MODULE_26___default=__webpack_require__.n(core_js_modules_es_typed_array_filter__WEBPACK_IMPORTED_MODULE_26__),core_js_modules_es_typed_array_find__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("d139"),core_js_modules_es_typed_array_find__WEBPACK_IMPORTED_MODULE_27___default=__webpack_require__.n(core_js_modules_es_typed_array_find__WEBPACK_IMPORTED_MODULE_27__),core_js_modules_es_typed_array_find_index__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("3a7b"),core_js_modules_es_typed_array_find_index__WEBPACK_IMPORTED_MODULE_28___default=__webpack_require__.n(core_js_modules_es_typed_array_find_index__WEBPACK_IMPORTED_MODULE_28__),core_js_modules_es_typed_array_for_each__WEBPACK_IMPORTED_MODULE_29__=__webpack_require__("d5d6"),core_js_modules_es_typed_array_for_each__WEBPACK_IMPORTED_MODULE_29___default=__webpack_require__.n(core_js_modules_es_typed_array_for_each__WEBPACK_IMPORTED_MODULE_29__),core_js_modules_es_typed_array_includes__WEBPACK_IMPORTED_MODULE_30__=__webpack_require__("82f8"),core_js_modules_es_typed_array_includes__WEBPACK_IMPORTED_MODULE_30___default=__webpack_require__.n(core_js_modules_es_typed_array_includes__WEBPACK_IMPORTED_MODULE_30__),core_js_modules_es_typed_array_index_of__WEBPACK_IMPORTED_MODULE_31__=__webpack_require__("e91f"),core_js_modules_es_typed_array_index_of__WEBPACK_IMPORTED_MODULE_31___default=__webpack_require__.n(core_js_modules_es_typed_array_index_of__WEBPACK_IMPORTED_MODULE_31__),core_js_modules_es_typed_array_iterator__WEBPACK_IMPORTED_MODULE_32__=__webpack_require__("60bd"),core_js_modules_es_typed_array_iterator__WEBPACK_IMPORTED_MODULE_32___default=__webpack_require__.n(core_js_modules_es_typed_array_iterator__WEBPACK_IMPORTED_MODULE_32__),core_js_modules_es_typed_array_join__WEBPACK_IMPORTED_MODULE_33__=__webpack_require__("5f96"),core_js_modules_es_typed_array_join__WEBPACK_IMPORTED_MODULE_33___default=__webpack_require__.n(core_js_modules_es_typed_array_join__WEBPACK_IMPORTED_MODULE_33__),core_js_modules_es_typed_array_last_index_of__WEBPACK_IMPORTED_MODULE_34__=__webpack_require__("3280"),core_js_modules_es_typed_array_last_index_of__WEBPACK_IMPORTED_MODULE_34___default=__webpack_require__.n(core_js_modules_es_typed_array_last_index_of__WEBPACK_IMPORTED_MODULE_34__),core_js_modules_es_typed_array_map__WEBPACK_IMPORTED_MODULE_35__=__webpack_require__("3fcc"),core_js_modules_es_typed_array_map__WEBPACK_IMPORTED_MODULE_35___default=__webpack_require__.n(core_js_modules_es_typed_array_map__WEBPACK_IMPORTED_MODULE_35__),core_js_modules_es_typed_array_reduce__WEBPACK_IMPORTED_MODULE_36__=__webpack_require__("ca91"),core_js_modules_es_typed_array_reduce__WEBPACK_IMPORTED_MODULE_36___default=__webpack_require__.n(core_js_modules_es_typed_array_reduce__WEBPACK_IMPORTED_MODULE_36__),core_js_modules_es_typed_array_reduce_right__WEBPACK_IMPORTED_MODULE_37__=__webpack_require__("25a1"),core_js_modules_es_typed_array_reduce_right__WEBPACK_IMPORTED_MODULE_37___default=__webpack_require__.n(core_js_modules_es_typed_array_reduce_right__WEBPACK_IMPORTED_MODULE_37__),core_js_modules_es_typed_array_reverse__WEBPACK_IMPORTED_MODULE_38__=__webpack_require__("cd26"),core_js_modules_es_typed_array_reverse__WEBPACK_IMPORTED_MODULE_38___default=__webpack_require__.n(core_js_modules_es_typed_array_reverse__WEBPACK_IMPORTED_MODULE_38__),core_js_modules_es_typed_array_set__WEBPACK_IMPORTED_MODULE_39__=__webpack_require__("3c5d"),core_js_modules_es_typed_array_set__WEBPACK_IMPORTED_MODULE_39___default=__webpack_require__.n(core_js_modules_es_typed_array_set__WEBPACK_IMPORTED_MODULE_39__),core_js_modules_es_typed_array_slice__WEBPACK_IMPORTED_MODULE_40__=__webpack_require__("2954"),core_js_modules_es_typed_array_slice__WEBPACK_IMPORTED_MODULE_40___default=__webpack_require__.n(core_js_modules_es_typed_array_slice__WEBPACK_IMPORTED_MODULE_40__),core_js_modules_es_typed_array_some__WEBPACK_IMPORTED_MODULE_41__=__webpack_require__("649e"),core_js_modules_es_typed_array_some__WEBPACK_IMPORTED_MODULE_41___default=__webpack_require__.n(core_js_modules_es_typed_array_some__WEBPACK_IMPORTED_MODULE_41__),core_js_modules_es_typed_array_sort__WEBPACK_IMPORTED_MODULE_42__=__webpack_require__("219c"),core_js_modules_es_typed_array_sort__WEBPACK_IMPORTED_MODULE_42___default=__webpack_require__.n(core_js_modules_es_typed_array_sort__WEBPACK_IMPORTED_MODULE_42__),core_js_modules_es_typed_array_subarray__WEBPACK_IMPORTED_MODULE_43__=__webpack_require__("170b"),core_js_modules_es_typed_array_subarray__WEBPACK_IMPORTED_MODULE_43___default=__webpack_require__.n(core_js_modules_es_typed_array_subarray__WEBPACK_IMPORTED_MODULE_43__),core_js_modules_es_typed_array_to_locale_string__WEBPACK_IMPORTED_MODULE_44__=__webpack_require__("b39a"),core_js_modules_es_typed_array_to_locale_string__WEBPACK_IMPORTED_MODULE_44___default=__webpack_require__.n(core_js_modules_es_typed_array_to_locale_string__WEBPACK_IMPORTED_MODULE_44__),core_js_modules_es_typed_array_to_string__WEBPACK_IMPORTED_MODULE_45__=__webpack_require__("72f7"),core_js_modules_es_typed_array_to_string__WEBPACK_IMPORTED_MODULE_45___default=__webpack_require__.n(core_js_modules_es_typed_array_to_string__WEBPACK_IMPORTED_MODULE_45__),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_46__=__webpack_require__("ddb0"),core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_46___default=__webpack_require__.n(core_js_modules_web_dom_collections_iterator__WEBPACK_IMPORTED_MODULE_46__),core_js_modules_web_url__WEBPACK_IMPORTED_MODULE_47__=__webpack_require__("2b3d"),core_js_modules_web_url__WEBPACK_IMPORTED_MODULE_47___default=__webpack_require__.n(core_js_modules_web_url__WEBPACK_IMPORTED_MODULE_47__),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_48__=__webpack_require__("96cf"),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_48___default=__webpack_require__.n(regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_48__),_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_49__=__webpack_require__("d4ec"),_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_50__=__webpack_require__("bee2"),_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_51__=__webpack_require__("b85c"),_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__=__webpack_require__("1da1"),_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_53__=__webpack_require__("2909"),axios__WEBPACK_IMPORTED_MODULE_54__=__webpack_require__("bc3a"),axios__WEBPACK_IMPORTED_MODULE_54___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_54__),js_yaml__WEBPACK_IMPORTED_MODULE_55__=__webpack_require__("651e"),js_yaml__WEBPACK_IMPORTED_MODULE_55___default=__webpack_require__.n(js_yaml__WEBPACK_IMPORTED_MODULE_55__),spdx_license_list_full__WEBPACK_IMPORTED_MODULE_56__=__webpack_require__("0d52"),spdx_license_list_full__WEBPACK_IMPORTED_MODULE_56___default=__webpack_require__.n(spdx_license_list_full__WEBPACK_IMPORTED_MODULE_56__),MAX_RDF_VERSION="0.3.2";function randId(){return Math.random().toString(36).substr(2,10)}function longestCommonSubstring(e,t){for(var r=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_53__["a"])(e),a=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_53__["a"])(t),n=Array(a.length+1).fill(null).map((function(){return Array(r.length+1).fill(null)})),s=0;s<=r.length;s+=1)n[0][s]=0;for(var o=0;o<=a.length;o+=1)n[o][0]=0;for(var i=0,c=0,l=0,u=1;u<=a.length;u+=1)for(var _=1;_<=r.length;_+=1)r[_-1]===a[u-1]?n[u][_]=n[u-1][_-1]+1:n[u][_]=0,n[u][_]>i&&(i=n[u][_],c=_,l=u);if(0===i)return"";var d="";while(n[l][c]>0)d=r[c-1]+d,l-=1,c-=1;return d}function fetchFile(e,t,r){return _fetchFile.apply(this,arguments)}function _fetchFile(){return _fetchFile=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t,r,a){var n,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,axios__WEBPACK_IMPORTED_MODULE_54___default()({url:t,method:"GET",responseType:"blob",onDownloadProgress:function(e){var t="Downloading file ".concat(e.loaded/1e3,"kB (").concat(e.total&&Math.round(e.loaded/e.total*100),"%)");a?a(t):console.log(t)}});case 2:return n=e.sent,r=r||t.split("/").pop().split("#")[0].split("?")[0],s=new Blob([n.data]),o=new File([s],r,{type:"application/octet-stream",lastModified:Date.now()}),e.abrupt("return",o);case 7:case"end":return e.stop()}}),e)}))),_fetchFile.apply(this,arguments)}function resolveDOI(e){return _resolveDOI.apply(this,arguments)}function _resolveDOI(){return _resolveDOI=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://doi.org/api/handles/"+t);case 2:if(r=e.sent,!r.ok){e.next=10;break}return e.next=6,r.json();case 6:return a=e.sent,e.abrupt("return",a.values.filter((function(e){return"URL"===e.type}))[0].data.value);case 10:throw new Error("Failed to resolve DOI:"+t);case 11:case"end":return e.stop()}}),e)}))),_resolveDOI.apply(this,arguments)}function dataURLtoFile(e,t){var r=e.split(","),a=r[0].match(/:(.*?);/)[1],n=atob(r[1]),s=n.length,o=new Uint8Array(s);while(s--)o[s]=n.charCodeAt(s);return new File([o],t,{type:a})}function resizeImage(e){var t=e.file,r=e.maxSize,a=new FileReader,n=new Image,s=document.createElement("canvas"),o=function(e){for(var t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],a=t.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=t.charCodeAt(s);return new Blob([n],{type:r})},i=function(){var e=n.width,t=n.height;e>t?e>r&&(t*=r/e,e=r):t>r&&(e*=r/t,t=r),s.width=e,s.height=t,s.getContext("2d").drawImage(n,0,0,e,t);var a=s.toDataURL("image/jpeg");return o(a)};return new Promise((function(e,r){t.type.match(/image.*/)?(a.onload=function(t){n.onload=function(){return e(i())},n.src=t.target.result},a.readAsDataURL(t)):r(new Error("Not an image"))}))}function getAbsoluteUrl(e,t){return t?(e.endsWith("/")||(e+="/"),t.startsWith("http")?t:new URL(t,e).href):t}function getFullRdfFromDeposit(e,t){return _getFullRdfFromDeposit.apply(this,arguments)}function _getFullRdfFromDeposit(){return _getFullRdfFromDeposit=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,s,o,i,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(t.rdf_source);case 2:if(a=e.sent,!a.ok){e.next=20;break}return e.next=6,a.text();case 6:n=e.sent,s=js_yaml__WEBPACK_IMPORTED_MODULE_55___default.a.load(n),s.id=t.id,s.conversions=t.conversions,o=t.rdf_source+"/files",r&&(s.documentation=getAbsoluteUrl(o,s.documentation),s.covers&&(s.covers=s.covers.map((function(e){return getAbsoluteUrl(o,e)})))),s.config=s.config||{},Object.assign(s.config,t.config),i=s.attachments.samples,c=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_51__["a"])(i);try{for(u=function(){var e,r=l.value,a=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_51__["a"])(r.files);try{for(a.s();!(e=a.n()).done;){var n=e.value,i={};if(i.download_url="".concat(o,"/").concat(r.name,"/").concat(n.name),i.name=n.name,s.conversions&&s.conversions[r.name]&&s.conversions[r.name][n.name]){var c=s.conversions[r.name][n.name];if(c["potree"]){var u="https://imjoy-s3.pasteur.fr/public/pointclouds/".concat(t.doi,"/").concat(r.name,"/").concat(c["potree"][0]);i.preview_url="https://shareloc.xyz/shareloc-potree-viewer.html?pointShape=circle&pointSizeType=adaptive&unit=nm&name=".concat(r.name,"/").concat(i.name,"&load=").concat(u)}c["csv"]&&(i.csv=c["csv"].map((function(e){return{name:e,url:"https://imjoy-s3.pasteur.fr/public/pointclouds/".concat(t.doi,"/").concat(r.name,"/").concat(e)}})))}Object.assign(n,i)}}catch(f){a.e(f)}finally{a.f()}var _,d=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_51__["a"])(r.views);try{for(d.s();!(_=d.n()).done;){var p=_.value;p.image||(p.image="".concat(o,"/").concat(r.name,"/").concat(Array.isArray(p.image_name)?p.image_name[0]:p.image_name))}}catch(f){d.e(f)}finally{d.f()}},c.s();!(l=c.n()).done;)u()}catch(_){c.e(_)}finally{c.f()}return e.abrupt("return",s);case 20:throw new Error("Failed to fetch RDF file.");case 21:case"end":return e.stop()}}),e)}))),_getFullRdfFromDeposit.apply(this,arguments)}var additionalNote=" (Uploaded via https://shareloc.xyz)";function rdfToMetadata(e,t,r){if(!spdx_license_list_full__WEBPACK_IMPORTED_MODULE_56___default.a[e.license])throw new Error("Invalid license, the license identifier must be one from the SPDX license list (https://spdx.org/licenses/)");if(!e.type)throw new Error("`type` key is not defined in the RDF.");e.covers=e.covers||[];var a,n=e.covers.map((function(e){return e.startsWith("http")?e:new URL(e,t).href})),s=[],o=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_51__["a"])(n);try{for(o.s();!(a=o.n()).done;){var i=a.value;if(i.includes("access_token="))throw new Error("Cover URL should not contain access token: "+i);s.push({relation:"hasPart",identifier:i,resource_type:"image-figure",scheme:"url"})}}catch(h){o.e(h)}finally{o.f()}e.links=e.links||[];var c,l=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_51__["a"])(e.links);try{for(l.s();!(c=l.n()).done;){var u=c.value;if(u.includes("access_token="))throw new Error("Link should not contain access token: "+u);s.push({identifier:"https://shareloc.xyz/#/r/"+encodeURIComponent(u),relation:"references",resource_type:"other",scheme:"url"})}}catch(h){l.e(h)}finally{l.f()}if(!e.config._rdf_file)throw new Error("`_rdf_file` key is not found in the RDF config");if(s.push({identifier:e.config._rdf_file.startsWith("http")?e.config._rdf_file:new URL(e.config._rdf_file,t).href,relation:"isCompiledBy",resource_type:"other",scheme:"url"}),e.documentation){if(e.documentation.includes("access_token="))throw new Error("Documentation URL should not contain access token");s.push({identifier:e.documentation.startsWith("http")?e.documentation:new URL(e.documentation,t).href,relation:"isDocumentedBy",resource_type:"publication-technicalnote",scheme:"url"})}e.authors=e.authors||[];var _=e.authors.map((function(e){return"string"===typeof e?{name:e.split(";")[0],affiliation:""}:{name:e.name.split(";")[0],affiliation:e.affiliation,orcid:e.orcid}})),d='<a href="https://shareloc.xyz/#/r/zenodo:'.concat(encodeURIComponent(e.config._deposit.id),'"><span class="label label-success">Open in Shareloc.XYZ</span></a><br>')+(r&&"<p>".concat(r,"</p>")||""),p=["shareloc.xyz","shareloc.xyz:"+e.type],f={title:e.name,description:d,access_right:"open",license:e.license,upload_type:"other",creators:_,publication_date:(new Date).toISOString().split("T")[0],keywords:p.concat(e.tags),notes:e.description+additionalNote,related_identifiers:s,communities:[]};return f}function depositionToRdf(e){var t=e.metadata,r=t.keywords.filter((function(e){return e.startsWith("shareloc.xyz:")}))[0];if(!r)throw new Error("deposit (".concat(e.id,') does not contain a shareloc.xyz type keyword starts with "shareloc.xyz:<TYPE>"'));r=r.replace("shareloc.xyz:","");var a,n=[],s=[],o=[],i=null,c=null,l=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_51__["a"])(t.related_identifiers);try{for(l.s();!(a=l.n()).done;){var u=a.value;if("isCompiledBy"===u.relation&&"url"===u.scheme){i=u.identifier;var _=i.includes("/api/files/")?/.*zenodo.org\/api\/files\/.*\/(.*)/:/.*zenodo.org\/.*\/files\/(.*)/,d=_.exec(i);if(!d)throw new Error("Invalid file identifier: "+u.identifier);var p=d[1];i="".concat(e.links.bucket,"/").concat(p)}else if("hasPart"===u.relation&&"image-figure"===u.resource_type&&"url"===u.scheme){var f=u.identifier;if(f.startsWith("file://"))f=f.replace("file://",e.links.bucket+"/");else if(f.includes("/files/")){var h=f.includes("/api/files/")?/.*zenodo.org\/api\/files\/.*\/(.*)/:/.*zenodo.org\/.*\/files\/(.*)/,m=h.exec(f);if(m){var g=m[1];f="".concat(e.links.bucket,"/").concat(g)}else console.error("Invalid cover image file identifier: "+u.identifier)}else console.error("Invalid cover image file identifier: "+u.identifier);n.push(f)}else if("references"===u.relation&&"url"===u.scheme&&u.identifier.startsWith("https://shareloc.xyz/#/r/")){var b=u.identifier.replace("https://shareloc.xyz/#/r/","");o.push(decodeURIComponent(b))}else if("isDocumentedBy"===u.relation&&"url"===u.scheme){var v=u.identifier.split("/files/")[1];c=v?"".concat(e.links.bucket,"/").concat(v):u.identifier}}}catch(w){l.e(w)}finally{l.f()}var y=t.notes.replace(additionalNote,"");if(!i)throw new Error("Invalid deposit (".concat(e.id,'), rdf.yaml is not defined in the metadata (as part of the "related_identifiers")'));return{id:e.conceptrecid,name:t.title,type:r,authors:t.creators,tags:t.keywords.filter((function(e){return"shareloc.xyz"!==e||!e.startsWith("shareloc.xyz:")})).concat(["zenodo"]),description:y,stats:e.stats,license:"string"===typeof t.license?t.license:t.license.id,documentation:c,covers:n,source:i,links:o,attachments:{samples:s},owners:e.owners,rdf_source:i,config:{_doi:e.doi,_conceptdoi:e.conceptdoi,_deposit:e,_rdf_file:i}}}var ZenodoClient=function(){function e(t,r,a){var n=this;Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_49__["a"])(this,e),this.baseURL=t,this.clientId=r,this.isSandbox=a,this.lastUserId=null,this.callbackUrl=encodeURIComponent("https://imjoy.io/login-helper"),this.credential=null,this.credentialKey=a?"sandbox_zenodo_credential":"production_zenodo_credential",this.userIdKey=a?"sandbox_zenodo_user_id":"production_zenodo_user_id";try{this.lastUserId=localStorage.getItem(this.userIdKey),this.lastUserId&&(this.lastUserId=parseInt(this.lastUserId));var s=localStorage.getItem(this.credentialKey);s&&(this.credential=JSON.parse(s),this.getCredential(),this.lastUserId!==this.credential.user_id&&(this.lastUserId=this.credential.user_id,localStorage.setItem(this.userIdKey,this.lastUserId)),fetch("".concat(this.baseURL,"/api/deposit/depositions?access_token=").concat(this.credential.access_token)).then((function(e){e.ok||(n.credential=null)})))}catch(o){console.error("Failed to reset ".concat(this.credentialKey,": ").concat(o)),localStorage.removeItem(this.credentialKey)}}return Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_50__["a"])(e,[{key:"getCredential",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=60*(r||40)*1e3,!this.credential){e.next=8;break}if(!(this.credential.create_at+1e3*parseInt(this.credential.expires_in)>Date.now()-r)){e.next=6;break}return e.abrupt("return",this.credential);case 6:this.credential=null;try{localStorage.removeItem(this.credentialKey)}catch(a){console.error("Failed to reset ".concat(this.credentialKey,": ").concat(a))}case 8:if(!t){e.next=21;break}return e.prev=9,e.next=12,this.login();case 12:e.next=21;break;case 14:if(e.prev=14,e.t0=e["catch"](9),!confirm("Failed to login: ".concat(e.t0,", would you like to try again?"))){e.next=20;break}return e.next=19,this.getCredential(t);case 19:return e.abrupt("return",e.sent);case 20:throw e.t0;case 21:return e.abrupt("return",this.credential);case 22:case"end":return e.stop()}}),e,this,[[9,14]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"getResourceItems",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,s,o,i,c,l,u,_,d,p,f,h,m=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.community,a=t.page,n=t.type,s=t.keywords,o=t.query,i=t.sort,c=t.size,a=a||1,n=n||"all",s=s||[],s.includes("shareloc.xyz")||s.push("shareloc.xyz"),c=c||20,i=i||"mostrecent",l="all"!==n?"&keywords=shareloc.xyz:"+n:"",u=l+(s.length>0?"&"+s.map((function(e){return"keywords="+e})).join("&"):"")+(o?"&q="+o:""),_="".concat(this.baseURL,"/api/records/?").concat(r?"communities="+r:"","&sort=").concat(i,"&page=").concat(a,"&size=").concat(c)+u,e.next=12,fetch(_);case 12:return d=e.sent,e.t0=JSON,e.next=16,d.text();case 16:return e.t1=e.sent,p=e.t0.parse.call(e.t0,e.t1),p&&p.hits||(console.warn("Hitting rate limit, retrying in 1s"),setTimeout((function(){m.getResourceItems({community:r,page:a,type:n,keywords:s,query:o,sort:i,size:c})}),1e3)),f=p.hits.hits,h=f.map((function(e){try{return depositionToRdf(e)}catch(t){return console.warn(t),null}})),console.log("Get items from URL: ",h,_),e.abrupt("return",h.filter((function(e){return!!e})));case 23:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getUserId",value:function(){return this.credential&&this.credential.user_id||this.lastUserId}},{key:"logout",value:function(){var e=this;return new Promise((function(t,r){e.credential=null;try{localStorage.removeItem(e.credentialKey)}catch(o){console.error("Failed to reset ".concat(e.credentialKey))}var a=window.open("".concat(e.baseURL,"/logout"),"Logout");try{a.focus()}catch(o){return void r("Logout window blocked. If you have a popup blocker enabled, please add shareloc.xyz to your exception list.")}var n=120,s=setInterval((function(){a.closed?(clearInterval(s),t()):(n--,n<=0&&(clearInterval(s),a.close(),r("Timeout error")))}),1e3);setTimeout((function(){a.close()}),1e3)}))}},{key:"login",value:function(){var e=this;return new Promise((function(t,r){if(e.lastUserId||confirm("Redirecting to Zenodo.org. If you failed to login, please come back here to try it again.")){var a=randId(),n=window.open("".concat(e.baseURL,"/oauth/authorize?scope=deposit%3Awrite+deposit%3Aactions&state=").concat(a,"&redirect_uri=").concat(e.callbackUrl,"&response_type=token&client_id=").concat(e.clientId),"Login");try{n.focus()}catch(l){return void r("Login window blocked. If you have a popup blocker enabled, please add shareloc.xyz to your exception list.")}e.credential=null;var s=120,o=!1,i=setInterval((function(){o?clearInterval(i):n.closed?(clearInterval(i),r("The login window was closed unexpectedly")):(s--,s<=0&&(clearInterval(i),n.close(),r("Timeout error")))}),1e3),c=function s(c){if(n===c.source){if(window.removeEventListener("message",s),clearInterval(i),n.close(),o=!0,e.credential)return;if(c.data.error)return void setTimeout((function(){r(c.data.error)}),1);if(!c.data.access_token||c.data.state!==a)return void r("Failed to obtain the access token, please make sure your account is valid and try it again.");console.log("Successfully logged in",c.data),e.credential=c.data,e.credential.user_id=parseInt(/'id': u'([0-9]+)'/gm.exec(c.data.user)[1]),e.credential.create_at=Date.now(),e.lastUserId!==e.credential.user_id&&(e.lastUserId=e.credential.user_id,localStorage.setItem(e.userIdKey,e.lastUserId)),t(c.data),localStorage.setItem(e.credentialKey,JSON.stringify(e.credential))}};window.addEventListener("message",c,!1)}}))}},{key:"createDeposition",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={"Content-Type":"application/json"},e.next=3,fetch("".concat(this.baseURL,"/api/deposit/depositions?access_token=").concat(this.credential.access_token),{method:"POST",body:JSON.stringify({}),headers:t});case 3:if(r=e.sent,!r.ok){e.next=10;break}return e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 10:return e.t0=Error,e.next=13,r.text();case 13:throw e.t1=e.sent,e.t2="Failed to create deposition, error: "+e.t1,new e.t0(e.t2);case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getDeposit",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id?t.id:t,e.next=3,fetch("".concat(this.baseURL,"/api/records/").concat(r),{method:"GET"});case 3:if(a=e.sent,!a.ok){e.next=10;break}return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Failed to get deposit: "+r);case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"retrieve",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id?t.id:t,e.next=3,fetch("".concat(this.baseURL,"/api/deposit/depositions/").concat(r,"?access_token=").concat(this.credential.access_token),{method:"GET"});case 3:if(a=e.sent,!a.ok){e.next=10;break}return e.next=7,a.json();case 7:return e.abrupt("return",e.sent);case 10:throw new Error("Failed to retrieve deposit: "+r);case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"edit",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id?t.id:t,a={"Content-Type":"application/json"},e.next=4,fetch("".concat(this.baseURL,"/api/deposit/depositions/").concat(r,"/actions/edit?access_token=").concat(this.credential.access_token),{method:"POST",body:JSON.stringify({}),headers:a});case 4:if(n=e.sent,!n.ok){e.next=11;break}return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:throw new Error("Failed to edit deposit: "+r);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"discard",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r="string"===typeof t?t:t.id,a={"Content-Type":"application/json"},e.next=4,fetch("".concat(this.baseURL,"/api/deposit/depositions/").concat(r,"/actions/discard?access_token=").concat(this.credential.access_token),{method:"POST",body:JSON.stringify({}),headers:a});case 4:if(n=e.sent,!n.ok){e.next=11;break}return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:throw new Error("Failed to discard deposit: "+r);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createNewVersion",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r="string"===typeof t?t:t.id,a={"Content-Type":"application/json"},e.next=4,fetch("".concat(this.baseURL,"/api/deposit/depositions/").concat(r,"/actions/newversion?access_token=").concat(this.credential.access_token),{method:"POST",body:JSON.stringify({}),headers:a});case 4:if(n=e.sent,!n.ok){e.next=11;break}return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 11:throw new Error("Failed to create a new version for deposit: "+r);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateMetadata",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t,r){var a,n,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a="string"===typeof t?t:t.id,console.log("Updating deposition metadata of ".concat(a,":"),r),n={"Content-Type":"application/json"},e.next=5,fetch("".concat(this.baseURL,"/api/deposit/depositions/").concat(a,"?access_token=").concat(this.credential.access_token),{method:"PUT",body:JSON.stringify({metadata:r}),headers:n});case 5:if(s=e.sent,!s.ok){e.next=12;break}return e.next=9,s.json();case 9:return e.abrupt("return",e.sent);case 12:return e.next=14,s.json();case 14:throw o=e.sent,new Error("Failed to update metadata, error: "+JSON.stringify(o.errors||o.message));case 16:case"end":return e.stop()}}),e,this)})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"uploadFile",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t,r,a,n){var s,o,i,c,l,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.links.bucket,o=a||r.name,i={headers:{"Content-Type":r.type},onUploadProgress:function(e){if(n)n(e.loaded);else{var t=Math.round(1*e.loaded/r.size*100);console.log("uploading annotation, size: "+Math.round(e.loaded/1e6)+"MB, "+t+"% uploaded.")}}},e.prev=3,l="".concat(s,"/").concat(o,"?access_token=").concat(this.credential.access_token),e.next=7,axios__WEBPACK_IMPORTED_MODULE_54___default.a.put(l,r,i);case 7:c=e.sent,e.next=21;break;case 10:return e.prev=10,e.t0=e["catch"](3),console.error(e.t0),console.error("Failed to upload, possibly due to access token expired:",e.t0),alert("Authentication information expired, please login to Zenodo and authorize ShareLoc.XYZ again."),e.next=17,this.login();case 17:return u="".concat(s,"/").concat(o,"?access_token=").concat(this.credential.access_token),e.next=20,axios__WEBPACK_IMPORTED_MODULE_54___default.a.put(u,r,i);case 20:c=e.sent;case 21:return e.abrupt("return",c.data);case 22:case"end":return e.stop()}}),e,this,[[3,10]])})));function t(t,r,a,n){return e.apply(this,arguments)}return t}()},{key:"publish",value:function(){var e=Object(_home_runner_work_ShareLoc_XYZ_ShareLoc_XYZ_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_52__["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,s,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.id?t.id:t,a={"Content-Type":"application/json"},e.next=4,fetch("".concat(this.baseURL,"/api/deposit/depositions/").concat(r,"/actions/publish?access_token=").concat(this.credential.access_token),{method:"POST",body:JSON.stringify({}),headers:a});case 4:if(n=e.sent,!n.ok){e.next=16;break}return e.next=8,n.json();case 8:if(s=e.sent,!s.submitted||!s.doi_url){e.next=13;break}return e.abrupt("return",s);case 13:throw new Error("Failed to publish, error: "+JSON.stringify(s));case 14:e.next=20;break;case 16:return e.next=18,n.json();case 18:throw o=e.sent,new Error("Failed to publish, error: "+JSON.stringify(o.errors||o.message));case 20:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}();function compareVersions(v1,comparator,v2){if(comparator="="==comparator?"==":comparator,-1==["==","===","<","<=",">",">=","!=","!=="].indexOf(comparator))throw new Error("Invalid comparator. "+comparator);for(var v1parts=v1.split("."),v2parts=v2.split("."),maxLen=Math.max(v1parts.length,v2parts.length),part1,part2,cmp=0,i=0;i<maxLen&&!cmp;i++)part1=parseInt(v1parts[i],10)||0,part2=parseInt(v2parts[i],10)||0,part1<part2&&(cmp=1),part1>part2&&(cmp=-1);return eval("0"+comparator+cmp)}function debounce(e,t,r){var a;return function(){var n=this,s=arguments,o=function(){a=null,r||e.apply(n,s)},i=r&&!a;clearTimeout(a),a=setTimeout(o,t),i&&e.apply(n,s)}}function concatAndResolveUrl(e,t){for(var r=e.split("/"),a=t.split("/"),n=[],s=0,o=r.length;s<o;s++)if(".."==r[s])n.pop();else{if("."==r[s])continue;n.push(r[s])}for(var i=0,c=a.length;i<c;i++)if(".."==a[i])n.pop();else{if("."==a[i])continue;n.push(a[i])}var l=n.join("/"),u=/https:\/\/zenodo\.org\/api\/records\/(\d+)\/files\/([\w.]+)/,_=l.match(u);return _?l+"/content":l}function rel2abs(e,t){if(/^(https?|file|ftps?|mailto|javascript|data:image\/[^;]{2,9};):/i.test(e))return e;if("//"==e.substring(0,2))return location.protocol+e;if("/"==e.charAt(0))return t+e.slice(1);if(/^\s*$/.test(e))return"";e=t+e;while(/\/\.\.\//.test(e=e.replace(/[^/]+\/+\.\.\//g,"")));return e=e.replace(/\.$/,"").replace(/\/\./g,"").replace(/"/g,"%22").replace(/'/g,"%27").replace(/</g,"%3C").replace(/>/g,"%3E"),e}function replaceAllRelByAbs(e,t){var r="[^-a-z0-9:._]";t.endsWith("/")||(t+="/");var a="(?:;|(?!\\d))",n={" ":"(?:\\s|&nbsp;?|&#0*32"+a+"|&#x0*20"+a+")","(":"(?:\\(|&#0*40"+a+"|&#x0*28"+a+")",")":"(?:\\)|&#0*41"+a+"|&#x0*29"+a+")",".":"(?:\\.|&#0*46"+a+"|&#x0*2e"+a+")"},s={},o=n[" "]+"*",i="(?:[^>\"']*(?:\"[^\"]*\"|'[^']*'))*?[^>]*";function c(e){var t=e.toLowerCase();if(n[e])return n[e];for(var r=e.toUpperCase(),o="",i=0;i<e.length;i++){var c=t.charAt(i);if(s[c])o+=s[c];else{var l=r.charAt(i),u=[c];u.push("&#0*"+c.charCodeAt(0)+a),u.push("&#x0*"+c.charCodeAt(0).toString(16)+a),c!=l&&(u.push("&#0*"+l.charCodeAt(0)+a),u.push("&#x0*"+l.charCodeAt(0).toString(16)+a)),u="(?:"+u.join("|")+")",o+=s[c]=u}}return n[e]=o}function l(e,r,a,n){return r+rel2abs(a,t)+n}var u=new RegExp(c("/"),"g"),_=new RegExp(c("."),"g");function d(e,r,a,n){return a=a.replace(u,"/").replace(_,"."),r+rel2abs(a,t)+n}function p(t,a,n,s,o){"string"==typeof t&&(t=new RegExp(t,"gi")),a=r+a,n="string"==typeof n?n:"\\s*=\\s*",s="string"==typeof s?s:"",o="string"==typeof o?"?)("+o:")(";var i=new RegExp("("+a+n+'")([^"'+s+"]+"+o+")","gi"),c=new RegExp("("+a+n+"')([^'"+s+"]+"+o+")","gi"),u=new RegExp("("+a+n+")([^\"'][^\\s>"+s+"]*"+o+")","gi");e=e.replace(t,(function(e){return e.replace(i,l).replace(c,l).replace(u,l)}))}function f(t,a,n,s,o,i){"string"==typeof t&&(t=new RegExp(t,"gi")),a=r+a,s="string"==typeof s?s:"gi";var c,l=new RegExp("("+a+'\\s*=\\s*")([^"]*)',"gi"),u=new RegExp("("+a+"\\s*=\\s*')([^']+)","gi"),_=new RegExp("("+n+')([^"]+)(")',s),p=new RegExp("("+n+")([^']+)(')",s);if("string"==typeof o){i="string"==typeof i?i:"";var f=new RegExp("("+n+")([^\"'][^"+o+"]*"+(i?"?)("+i+")":")()"),s);c=function(e,t,r){return t+r.replace(_,d).replace(p,d).replace(f,d)}}else c=function(e,t,r){return t+r.replace(_,d).replace(p,d)};e=e.replace(t,(function(e){return e.replace(l,c).replace(u,c)}))}return f("<meta"+i+r+'http-equiv\\s*=\\s*(?:"'+c("refresh")+'"'+i+">|'"+c("refresh")+"'"+i+">|"+c("refresh")+"(?:"+c(" ")+i+">|>))","content",c("url")+o+c("=")+o,"i"),p("<"+i+r+"href\\s*="+i+">","href"),p("<"+i+r+"src\\s*="+i+">","src"),p("<object"+i+r+"data\\s*="+i+">","data"),p("<applet"+i+r+"codebase\\s*="+i+">","codebase"),p("<param"+i+r+'name\\s*=\\s*(?:"'+c("movie")+'"'+i+">|'"+c("movie")+"'"+i+">|"+c("movie")+"(?:"+c(" ")+i+">|>))","value"),p(/<style[^>]*>(?:[^"']*(?:"[^"]*"|'[^']*'))*?[^'"]*(?:<\/style|$)/gi,"url","\\s*\\(\\s*","","\\s*\\)"),f("<"+i+r+"style\\s*="+i+">","style",c("url")+o+c("(")+o,0,o+c(")"),c(")")),e}},"034f":function(e,t,r){"use strict";var a=r("85ec"),n=r.n(a);n.a},"05ff":function(e,t,r){"use strict";var a=r("1dce"),n=r.n(a);n.a},"106f":function(e,t,r){"use strict";var a=r("944d"),n=r.n(a);n.a},"12a0":function(e,t,r){"use strict";var a=r("ac16"),n=r.n(a);n.a},"133d":function(e){e.exports=JSON.parse('{"site_name":"ShareLoc.XYZ","site_icon":"ðŸ”¬","site_logo":"/static/img/shareloc-logo-white.svg","author":"IMOD","keywords":"SMLM,PALM,STORM,PAINT,SR,SuperRes,Super resolution,Microscopy,Live Cell Imaging,Bioimaging","description":"ShareLoc--An open platform for sharing single-molecule localization microscopy data and tools","twitter_site":"@ImodLab","twitter_creator":"@weioyang","twitter_image":"https://shareloc.xyz/static/img/shareloc-banner.png","og_url":"https://shareloc.xyz","og_title":"ShareLoc.XYZ","og_image":"https://shareloc.xyz/static/img/shareloc-banner.png","og_description":"An open platform for sharing single-molecule localization microscopy data and tools","background_image":"","builtin_manifest_url":"./shareloc.manifest.json","manifest_url":"https://hypha.aicell.io/shareloc-xyz/artifacts/shareloc-collection","explore_button_text":"ðŸš€ Explore","subscribe_url":"https://docs.google.com/forms/d/e/1FAIpQLSfQhTjXOuTXZNtalprbsXMPd4ct2ydiMhlPc2lhcs6WY4yo0w/viewform?embedded=true","contribute_url":"/docs/contribute.md","hypha_server_url":"https://hypha.aicell.io","join_partners_url":"","footer":[{"label":"User Agreement","tooltip":"Disclaimer, Terms of Use and Privacy Statements","url":"https://github.com/imodpasteur/ShareLoc.XYZ/blob/main/user-agreement.md#user-agreement"},{"label":"Source code","tooltip":"Github Repository","url":"https://github.com/imodpasteur/shareLoc.xyz"},{"label":"Report issues","tooltip":"Report an issue on Github","url":"https://github.com/imodpasteur/ShareLoc.XYZ/issues"},{"label":"Contact Us","tooltip":"Send us a private message","url":"https://oeway.typeform.com/to/rdkPmd"}],"zenodo_config":{"enabled":true,"sandbox_client_id":"LrUl7gtNg50dciX8wkXHCD7Sy75ZpEytUarkekWp","production_client_id":"hi4F8IWRtlIoZsAg3fJGF5lsHXAFr30NuYz8YHot","community":"shareloc","use_sandbox":false},"rdf_root_repo":"imodpasteur/shareLoc.xyz","enable_comment":true,"splash_title":"","splash_subtitle":"ShareLoc.XYZ: An open platform for sharing single-molecule localization microscopy data and tools","splash_feature_list":[],"table_view":{"columns":["name","authors","badges","apps"]},"attachment_table":{"columns":[{"field":"name","label":"Name","width":80,"sortable":true},{"field":"files","label":"Files","width":80,"type":"files","sortable":false},{"field":"description","label":"Description","width":100,"max_length":100,"sortable":true},{"field":"timestamp","label":"Timestamp","class":"tag is-success","sortable":true},{"field":"source","label":"Source","type":"url","text":"open","class":"button is-small"},{"field":"download_url","label":"Download","type":"url","text":"Download","class":"button is-small"},{"field":"views","label":"Views","width":180,"type":"thumbnails","sortable":false}],"detailed":true,"detailed_image":null,"detailed_body":"description"},"footnote":"ShareLoc.XZY is a community efforts for promoting open science","partners":[],"excluded_tags":["shareloc.xyz","shareloc.xyz:dataset","smlm","zenodo"],"resource_categories":[{"name":"Dataset","type":"dataset","description":"List datasets","outline_color":"rgb(138 138 138)","default_links":["smlm-viewer","shareloc-downloader"],"tag_categories":{"1.modality":["palm","storm","dstorm","dna-paint","paint"],"2.cell line":["u2os","u373","cos7","ref52","mdck","hela","nih3t3","yeast","e-coli","listeria","archaea","mef"],"3.structure":["microtubules","mitochondria","actin","nuclear-pore-complex","dna","plasma-membrane","neuronal-synapse","vimentin","clathrin"],"4.fluorophore":["alexa-647","alexa-532","cy5","phalloidin-647","cf680","hmsir","jf-646","pa-jf646","alexa-555","meos2","mapple","cy3b","cf568","dendra2","pa-mcherry","jf-568","pa-jf568","nile-red","pa-gfp","dronpa","atto-488","atto-520","atto-568"],"5.labeling strategy":["transient-transfection","stable-knock-in","endogenous-crispr-labeling","direct-immuno-labeling","indirect-immuno-labeling","halo-tag","snap-tag","tetracysteine-tag"],"6.target molecule":["nup133","nup96","tom22","wga","escrt","ftsz","alpha-tubulin","beta-tubulin","h2","h3","h1","polye","actin","gp210"],"7.dimension":["2d","3d"],"8.camera":["em-ccd","scmos"],"9.reconstruction software":["thunderstorm","smap","smoiphot","zola-3d","picasso","quickpalm"],"10.buffer":["gluox","catalase","mea","abbelight-safe-reagent","idylle-everspark"],"11.fixation":["4%pfa","1%pfa","pfa+gluta","glyoxal","methanol"]}},{"name":"Applications","type":"application","outline_color":"rgb(83 230 7)","description":"List software, web apps and utility tools"}]}')},1668:function(e,t,r){},"1dce":function(e,t,r){},"299b":function(e,t,r){},"409f":function(e,t,r){"use strict";var a=r("f2bc"),n=r.n(a);n.a},"478a":function(e,t,r){},4871:function(e,t,r){},"4a91":function(e,t,r){},"50cf":function(e,t,r){},"51a2":function(e,t,r){"use strict";var a=r("1668"),n=r.n(a);n.a},"560e":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("4160"),r("b64b"),r("159b");var a=r("5530"),n=(r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("2b0e")),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[e.showNavbar?r("nav",{staticClass:"navbar is-link is-fixed-top"},[r("div",{staticClass:"navbar-brand"},[r("a",{attrs:{href:"#/"}},[r("img",{staticStyle:{width:"264px","margin-left":"8px","margin-top":"6px"},attrs:{src:e.siteConfig.site_logo}})]),r("div",{staticClass:"navbar-burger burger",class:{"is-active":e.showMenu},attrs:{"data-target":"navbarExampleTransparentExample"},on:{click:function(t){e.showMenu=!e.showMenu}}},[r("span"),r("span"),r("span")])]),r("div",{staticClass:"navbar-menu",class:{"is-active":e.showMenu},attrs:{id:"navbarExampleTransparentExample"}},[r("div",{staticClass:"navbar-end"},[e.bookmarks&&e.bookmarks.length>0?r("b-dropdown",{staticClass:"navbar-item",staticStyle:{"margin-top":"6px"},attrs:{scrollable:!0,"max-height":200,"aria-role":"list"},scopedSlots:e._u([{key:"trigger",fn:function(){return[r("a",{staticClass:"navbar-item"},[r("b-icon",{staticStyle:{color:"white"},attrs:{icon:"bookmark"}})],1)]},proxy:!0}],null,!1,3325205805)},[e._l(e.bookmarks,(function(t,a){return r("b-dropdown-item",{key:a,attrs:{"aria-role":"listitem"},on:{click:function(r){return e.showResourceItemInfo(t)}}},[r("div",{staticClass:"media"},[r("b-icon",{staticClass:"media-left",attrs:{icon:"database"}}),r("div",{staticClass:"media-content"},[r("h3",[e._v(e._s(t.name))])])],1)])})),r("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(t){return e.uploadBookmarks()}}},[r("div",{staticClass:"media"},[r("b-icon",{staticClass:"media-left",attrs:{icon:"upload"}}),r("div",{staticClass:"media-content"},[r("h3",[e._v("Upload All")])])],1)]),r("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(t){return e.downloadBookmarks()}}},[r("div",{staticClass:"media"},[r("b-icon",{staticClass:"media-left",attrs:{icon:"cloud-download"}}),r("div",{staticClass:"media-content"},[r("h3",[e._v("Download All")])])],1)]),r("b-dropdown-item",{attrs:{"aria-role":"listitem"},on:{click:function(t){return e.clearBookmarks()}}},[r("div",{staticClass:"media"},[r("b-icon",{staticClass:"media-left",attrs:{icon:"close"}}),r("div",{staticClass:"media-content"},[r("h3",[e._v("Clear All")])])],1)])],2):e._e(),e.siteConfig.contribute_url&&"Upload"!==e.$route.name?r("a",{staticClass:"navbar-item",attrs:{href:"#/upload"}},[r("b-icon",{attrs:{icon:"plus"}}),r("span",[e._v("Upload")])],1):e._e(),"Viewer"!==e.$route.name?r("a",{staticClass:"navbar-item",attrs:{href:"#/viewer"}},[r("b-icon",{attrs:{icon:"eye-outline"}}),r("span",[e._v("Viewer")])],1):e._e(),r("a",{staticClass:"navbar-item",attrs:{href:"#/about"}},[r("b-icon",{attrs:{icon:"information-outline"}}),r("span",[e._v("About")])],1),r("a",{staticClass:"navbar-item",attrs:{id:"imjoy-menu"}})],1)])]):e._e(),r("router-view",{staticClass:"router-view",style:{marginTop:e.showNavbar?"72px":"0px"}})],1)},o=[],i=(r("96cf"),r("1da1")),c=r("2f62"),l=(r("d3b7"),r("ac1f"),r("3ca3"),r("841c"),r("1276"),r("ddb0"),r("2b3d"),r("b85c")),u=(r("a4d3"),r("e01a"),r("99af"),r("4de4"),r("7db0"),r("a630"),r("caad"),r("c975"),r("d81d"),r("a434"),r("b0c0"),r("c1f9"),r("6062"),r("8a79"),r("2532"),r("5319"),r("2ca0"),r("2909")),_=r("025e"),d=r("133d"),p=r("0d52"),f=r.n(p);n["default"].use(c["a"]);var h=(location.href.includes("#")?location.href.split("#")[1]:location.href).split("?")[1];if(h){var m=Object.fromEntries(new URLSearchParams(h).entries());d.zenodo_config.use_sandbox?m&&m["production"]&&(d.zenodo_config.use_sandbox=!1):m&&m["sandbox"]&&(d.zenodo_config.use_sandbox=!0)}d.table_view=d.table_view||{columns:["name","authors","badges","apps"]};var g,b=[],v=Object(l["a"])(d.resource_categories);try{for(v.s();!(g=v.n()).done;){var y=g.value,w=y.tag_categories;if(w)for(var k in w)b=b.concat(w[k])}}catch(fr){v.e(fr)}finally{v.f()}b=b.map((function(e){return e.toLowerCase().replace(/ /g,"-")}));var x=d.zenodo_config.use_sandbox?"https://sandbox.zenodo.org":"https://zenodo.org";function O(e){var t,r;if(!e.config||!e.config._normalized){e.config=e.config||{},e.covers=e.covers||[],e.authors=e.authors||[],e.description=e.description||"",e.covers&&!Array.isArray(e.covers)&&(e.covers=[e.covers]),"extension"===e.icon&&(e.icon="puzzle"),e.covers=e.covers.map((function(t){return t.startsWith("http")?t.includes(" ")?encodeURI(t):t:encodeURI(Object(_["b"])(e.root_url,t))})),e.covers.length<=0&&null!==e&&void 0!==e&&null!==(t=e.icon)&&void 0!==t&&t.startsWith("http")&&e.covers.push(e.icon),e.allLabels=e.labels||[],e.license&&e.allLabels.push(e.license),e.applications&&(e.allLabels=e.allLabels.concat(e.applications)),e.uploaded_by&&e.allLabels.push(e.uploaded_by),e.tags&&(e.tags=e.tags.map((function(e){return e.toLowerCase().replace(/ /g,"-")})),e.tags=e.tags.filter((function(e){return"string"===typeof e&&!d.excluded_tags.includes(e)})),e.allLabels=e.allLabels.concat(e.tags.map((function(e){return e.toLowerCase()})))),e.allLabels=Array.from(new Set(e.allLabels.map((function(e){return e.toLowerCase()})))),e.apps=e.apps||[],e.download_url&&e.apps.unshift({name:"Download",icon:"download",url:e.download_url,show_on_hover:!0}),e.git_repo&&e.apps.unshift({name:"Git Repository",icon:"github",url:e.git_repo,show_on_hover:!0}),e.badges=e.badges||[],e.attachments=e.attachments||{},e.license&&e.badges.unshift({label:"license",ext:e.license,ext_type:"is-info",url:f.a[e.license]&&f.a[e.license].url}),e.size&&e.badges.unshift({label:"size",label_type:"is-dark",ext:e.size>1e6?Math.round(e.size/1e6)+"MB":Math.round(e.size/1e3)+"kB",ext_type:"is-primary"}),"model"===e.type&&e.co2&&e.badges.unshift({label:"CO2",ext:e.co2,ext_type:"is-success",run:function(){alert("SAVE THE EARTH: The carbon footprint for training this model is around ".concat(e.co2," lbs, reusing existing models can help save the earth from climate change."))}}),e.error&&(e.error.spec?e.badges.unshift({label:"spec",label_type:"is-dark",ext:"failing",ext_type:"is-danger",run:function(){alert("This model failed the specification checks, here are the errors: \n"+JSON.stringify(e.error.spec,null,"  "))}}):e.badges.unshift({label:"spec",label_type:"is-dark",ext:"passing",ext_type:"is-success",run:function(){alert("ðŸŽ‰ This model passed the specification checks!")}}));var a=null===(r=e.attachments)||void 0===r?void 0:r.samples;if(a){var n,s=Object(l["a"])(a);try{var o=function(){var t,r=n.value,a=Object(l["a"])(r.files);try{for(a.s();!(t=a.n()).done;){var s=t.value,o={};if(o.download_url="".concat(e.root_url,"/").concat(r.name,"/").concat(s.name),o.name=s.name,e.conversions&&e.conversions[r.name]&&e.conversions[r.name][s.name]){var i=e.conversions[r.name][s.name];if(i["potree"]){var c="https://imjoy-s3.pasteur.fr/public/pointclouds/".concat(e.doi,"/").concat(r.name,"/").concat(i["potree"][0]);o.preview_url="https://shareloc.xyz/shareloc-potree-viewer.html?pointShape=circle&pointSizeType=adaptive&unit=nm&name=".concat(r.name,"/").concat(o.name,"&load=").concat(c)}i["csv"]&&(o.csv=i["csv"].map((function(t){return{name:t,url:"https://imjoy-s3.pasteur.fr/public/pointclouds/".concat(e.doi,"/").concat(r.name,"/").concat(t)}})))}Object.assign(s,o)}}catch(fr){a.e(fr)}finally{a.f()}var u,_=Object(l["a"])(r.views);try{for(_.s();!(u=_.n()).done;){var d=u.value;d.image||(d.image="".concat(e.root_url,"/").concat(r.name,"/").concat(Array.isArray(d.image_name)?d.image_name[0].replace(".png","_thumbnail.png"):d.image_name.replace(".png","_thumbnail.png")))}}catch(fr){_.e(fr)}finally{_.f()}};for(s.s();!(n=s.n()).done;)o()}catch(fr){s.e(fr)}finally{s.f()}}e.config._normalized=!0}}var E=null,C=null,I=new Promise((function(e,t){E=e,C=t}));function D(){return M.apply(this,arguments)}function M(){return M=Object(i["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,L();case 3:t=e.sent,E(t),e.next=11;break;case 7:e.prev=7,e.t0=e["catch"](0),C(e.t0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])}))),M.apply(this,arguments)}var P,R=d.zenodo_config.use_sandbox?d.zenodo_config.sandbox_client_id:d.zenodo_config.production_client_id,j=new c["a"].Store({state:{loadedUrl:null,allApps:{},allTags:Object(u["a"])(b),imjoy:null,resourceItems:[],zenodoClient:d.zenodo_config.enabled?new _["a"](x,R,d.zenodo_config.use_sandbox):null,zenodoBaseURL:x,siteConfig:d,imjoyReady:I,showNavbar:!0,bookmarks:[],eventBus:new n["default"]},actions:{toggleNavbar:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:e.state.showNavbar=t;case 1:case"end":return r.stop()}}),r)})))()},login:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.state.client.login();case 3:t.next=8;break;case 5:t.prev=5,t.t0=t["catch"](0),alert("Failed to login: ".concat(t.t0));case 8:case"end":return t.stop()}}),t,null,[[0,5]])})))()},fetchResourceItems:function(e,t){return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i,c,d,p,f,h,m,g,v,y,w,k,x,O,E,C,I,D,M,P;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=t.manifest_url,n=t.repo,s=t.transform,e.state.loadedUrl!==a){r.next=4;break}return console.log("manifest already loaded"),r.abrupt("return");case 4:return e.state.resourceItems=[],e.state.allApps={},e.state.allTags=Object(u["a"])(b),o=e.state.siteConfig,r.next=10,fetch(a+"?"+Object(_["h"])());case 10:return i=r.sent,r.t0=JSON,r.next=14,i.text();case 14:if(r.t1=r.sent,c=r.t0.parse.call(r.t0,r.t1),o.partners&&c.collections){d=Object(l["a"])(c.collections);try{for(f=function(){var e=p.value,t=o.partners.filter((function(t){return t.id===e.id}));t.forEach((function(e){o.partners.splice(o.partners.indexOf(e),1)})),o.partners.push(e)},d.s();!(p=d.n()).done;)f()}catch(fr){d.e(fr)}finally{d.f()}}if(!o.builtin_manifest_url){r.next=28;break}return r.next=20,fetch(o.builtin_manifest_url);case 20:return h=r.sent,r.t2=JSON,r.next=24,h.text();case 24:r.t3=r.sent,m=r.t2.parse.call(r.t2,r.t3),g=Object(l["a"])(m.resources);try{for(g.s();!(v=g.n()).done;)y=v.value,e.commit("addResourceItem",y)}catch(fr){g.e(fr)}finally{g.f()}case 28:return r.next=30,fetch(a+"/children");case 30:return w=r.sent,r.next=33,w.json();case 33:k=r.sent,x=JSON.parse(JSON.stringify(k)),O=a.split("/artifacts")[0]+"/artifacts",E=Object(l["a"])(x);try{for(E.s();!(C=E.n()).done;)I=C.value,D=I.manifest,D.id=I.alias,D.repo=n,D.root_url="".concat(O,"/").concat(I.alias,"/files"),D.rdf_source="".concat(O,"/").concat(I.alias),e.commit("addResourceItem",D)}catch(fr){E.e(fr)}finally{E.f()}e.commit("normalizeItems",s),s&&(e.state.loadedUrl=a);try{M=localStorage.getItem("bookmarks"),M&&(P=JSON.parse(M),e.state.bookmarks=e.state.resourceItems.filter((function(e){return P.includes(e.id)})),console.log("bookmarks restored",e.state.bookmarks))}catch(R){console.error(R)}case 41:case"end":return r.stop()}}),r)})))()}},mutations:{setImJoy:function(e,t){e.imjoy=t},addBookmark:function(e,t){var r=e.bookmarks.map((function(e){return e.id}));r.includes(t.id)||e.bookmarks.push(t);try{localStorage.setItem("bookmarks",JSON.stringify(r))}catch(a){console.error(a)}},removeBookmark:function(e,t){var r=e.bookmarks.map((function(e){return e.id})),a=r.indexOf(t.id);a>=0&&e.bookmarks.splice(a,1);try{localStorage.setItem("bookmarks",JSON.stringify(r))}catch(n){console.error(n)}},clearBookmarks:function(e){e.bookmarks=[];var t=e.bookmarks.map((function(e){return e.id}));try{localStorage.setItem("bookmarks",JSON.stringify(t))}catch(r){console.error(r)}},addResourceItem:function(e,t){var r;if(t.id=t.id||t[".prefix"]||Object(_["h"])(),t.id=t.id.toLowerCase(),t.links=t.links||[],t.links=t.links.map((function(e){return e.toLowerCase()})),t.authors=t.authors||[],t.authors=t.authors.map((function(e){return"string"===typeof e?{name:e}:e})),t.config=t.config||{},t.config._deposit){var a=e.zenodoClient&&e.zenodoClient.getUserId();a&&t.config._deposit.owners.includes(a)&&(t.tags.includes("editable")||t.tags.push("editable"))}t.config._rdf_file=t.config._rdf_file||t.source,"application"===t.type&&null!==t&&void 0!==t&&null!==(r=t.source)&&void 0!==r&&r.endsWith(".imjoy.html")&&(e.allApps[t.id]=t),t.tags&&t.tags.length>0?t.tags=t.tags.map((function(e){return e.toLowerCase().replace(/ /g,"-")})):t.tags=[],t.tags.map((function(t){e.allTags.includes(t)||e.allTags.push(t)})),e.resourceItems.push(t)},removeResourceItem:function(e,t){"application"===t.type&&delete e.allApps[t.id];var r=e.resourceItems.indexOf(t);r>=0&&e.resourceItems.splice(r,1)},normalizeItems:function(e,t){e.resourceItems.map((function(t){O(t);var r=d.resource_categories.find((function(e){return e.type===t.type}));if(r&&r.default_links){t.links=t.links||[];var a,n=Object(l["a"])(r.default_links);try{var s=function(){var r=a.value;e.resourceItems.find((function(e){return e.id===r}))?t.links.push(r):console.warn("Default link item not foud: "+r)};for(n.s();!(a=n.n()).done;)s()}catch(fr){n.e(fr)}finally{n.f()}}})),e.resourceItems=e.resourceItems.map((function(e){return e.id=e.id||Object(_["h"])(),e.id=e.id.toLowerCase(),e.links=e.links||[],e.links=e.links.map((function(e){return e.toLowerCase()})),e.links=Object(u["a"])(new Set(e.links)),t&&t(e),e}))}}});function L(){return T.apply(this,arguments)}function T(){return T=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){window.loadImJoyBasicApp({process_url_query:!0,show_window_title:!1,show_progress_bar:!0,show_empty_window:!0,hide_about_imjoy:!0,menu_style:{},window_style:{width:"100%",height:"100%"},main_container:null,menu_container:"imjoy-menu",window_manager_container:null,imjoy_api:{}}).then(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(r){var a,n,s,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=window.location.origin+window.location.pathname,r.imjoy.pm.default_base_frame=a+"default_base_frame.html",r.imjoy.pm.init(),P=r.imjoy.api,j.commit("setImJoy",r.imjoy),r.$on("window-size-pos-changing",(function(e){var t,r=document.querySelectorAll(".reveal iframe"),a=Object(l["a"])(r);try{for(a.s();!(t=a.n()).done;){var n=t.value;n.style.pointerEvents=e?"none":"all"}}catch(fr){a.e(fr)}finally{a.f()}})),r.addMenuItem({label:"âž• Load Plugin",callback:function(){var e=prompt("Please type a ImJoy plugin URL","");e&&r.loadPlugin(e)}}),t.next=9,r.imjoy.pm.reloadPluginRecursively({uri:a+"SMLM-File-IO.imjoy.html"});case 9:return t.next=11,r.loadPlugin(a+"ShareLoc-Downloader.imjoy.html");case 11:return t.next=13,r.loadPlugin(a+"FairyDust.imjoy.html");case 13:n=window.location.search,s=new URLSearchParams(n),o=s.get("engine"),i=s.get("spec"),r.imjoy.pm.reloadPluginRecursively({uri:"https://imjoy-team.github.io/jupyter-engine-manager/Jupyter-Engine-Manager.imjoy.html"}).then((function(e){o?e.api.createEngine({name:"MyCustomEngine",nbUrl:o,url:o.split("?")[0]}).then((function(){console.log("Jupyter Engine connected!")})).catch((function(e){console.error("Failed to connect to Jupyter Engine",e)})):e.api.createEngine({name:"MyBinder Engine",url:"https://mybinder.org",spec:i||"oeway/imjoy-binder-image/master"}).then((function(){console.log("Binder Engine connected!")})).catch((function(e){console.error("Failed to connect to MyBinder Engine",e)}))})),r.addMenuItem({label:"â„¹ï¸ Github",callback:function(){window.open("https://github.com/imodpasteur/shareLoc.xyz")}}),e(r.imjoy);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.error(e),t(e)}))})));case 1:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function S(e,t,r){return U.apply(this,arguments)}function U(){return U=Object(i["a"])(regeneratorRuntime.mark((function e(t,r,a){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(r,a),t.showLoader(!0),e.prev=2,!r.passive){e.next=7;break}return e.next=6,P.createWindow({src:r.source,passive:!0});case 6:return e.abrupt("return");case 7:return e.next=9,P.getPlugin({src:r.source});case 9:return n=e.sent,e.next=12,n.run({config:{referer:window.location.href,mode:"all",type:"shareloc.xyz"},data:a});case 12:t.showLoader(!1),e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](2),console.error(e.t0),P.showMessage("".concat(e.t0.message));case 19:return e.prev=19,t.showLoader(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,15,19,22]])}))),U.apply(this,arguments)}function A(e,t,r){return W.apply(this,arguments)}function W(){return W=Object(i["a"])(regeneratorRuntime.mark((function e(t,r,a){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log(r,a),t.showLoader(!0),e.prev=2,!r.passive){e.next=9;break}return e.next=6,P.createWindow({src:r.source,passive:!0});case 6:return n=e.sent,n.cancel&&t.showLoader(!0,(function(){n.cancel()})),e.abrupt("return");case 9:return e.next=11,P.getPlugin({src:r.source});case 11:return s=e.sent,t.showLoader(!1),s.cancel?t.showLoader(!0,(function(){s.cancel()})):t.showLoader(!0),e.next=16,s.run({config:{referer:window.location.href,mode:"one",type:"shareloc.xyz"},data:a});case 16:e.next=22;break;case 18:e.prev=18,e.t0=e["catch"](2),console.error(e.t0),P.showMessage("".concat(e.t0.message));case 22:return e.prev=22,t.showLoader(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[2,18,22,25]])}))),W.apply(this,arguments)}var B={name:"App",data:function(){return{showMenu:!1,loadingComponent:null}},computed:Object(a["a"])({},Object(c["b"])({showNavbar:function(e){return e.showNavbar},siteConfig:function(e){return e.siteConfig},bookmarks:function(e){return e.bookmarks},eventBus:function(e){return e.eventBus}})),methods:{showResourceItemInfo:function(e){this.eventBus.$emit("showResourceItemInfo",e)},clearBookmarks:function(){this.$store.commit("clearBookmarks")},showLoader:function(e,t){e?this.loadingComponent=this.$buefy.loading.open({canCancel:!0,onCancel:function(){t&&t()}}):this.loadingComponent&&(this.loadingComponent.close(),this.loadingComponent=null)},uploadBookmarks:function(){this.$router.push({name:"Update",params:{updateDepositId:"bookmarks"}})},downloadBookmarks:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=window.location.origin+window.location.pathname,t.next=3,S(e,{source:r+"ShareLoc-Downloader.imjoy.html"},e.bookmarks);case 3:case"end":return t.stop()}}),t)})))()}}},F=B,K=(r("034f"),r("2877")),q=Object(K["a"])(F,s,o,!1,null,null,null),z=q.exports,$=r("9483");Object($["a"])("".concat("/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var N,Y=r("8c4f"),Z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home"},[r("section",{staticClass:"hero is-link is-fullheight is-fullheight-with-navbar",staticStyle:{"max-height":"1024px!important","min-height":"380px","background-image":"url(/static/img/bg.jpg)"}},[r("div",{staticClass:"hero-body",staticStyle:{position:"relative"}},[e.selectedPartner?r("img",{staticClass:"background-img",attrs:{src:e.selectedPartner.background_image}}):r("img",{staticClass:"background-img",attrs:{src:e.siteConfig.background_image}}),e.selectedPartner?r("div",{staticClass:"container"},[r("h1",{staticClass:"title is-1"},[e._v(" "+e._s(e.selectedPartner.splash_title)+" ")]),r("h2",{staticClass:"subtitle is-3"},[e._v(" "+e._s(e.selectedPartner.splash_subtitle)+" ")]),e.selectedPartner.splash_feature_list?r("ul",{staticClass:"feature-list"},e._l(e.selectedPartner.splash_feature_list,(function(t){return r("li",{key:t},[e._v(" "+e._s(t)+" ")])})),0):e._e(),r("br"),e.selectedPartner.about_url?r("b-button",{staticStyle:{"text-transform":"none"},attrs:{rounded:""},on:{click:function(t){return e.showAboutPartner(e.selectedPartner)}}},[r("span",{staticClass:"explore-btn"},[e._v("About")])]):e._e()],1):r("div",{staticClass:"container"},[r("h1",{staticClass:"title is-1"},[e._v(" "+e._s(e.siteConfig.splash_title)+" ")]),r("h2",{staticClass:"subtitle is-3"},[e._v(" "+e._s(e.siteConfig.splash_subtitle)+" ")]),e.siteConfig.splash_feature_list?r("ul",{staticClass:"feature-list"},e._l(e.siteConfig.splash_feature_list,(function(t){return r("li",{key:t},[e._v(" "+e._s(t)+" ")])})),0):e._e(),r("br")])])]),r("br"),r("section",{staticStyle:{"margin-top":"-30px",opacity:"0.6"}},[r("b-progress",{attrs:{value:e.progress}})],1),r("br"),r("span",{ref:"search_anchor"}),e.resourceCategories.length>1?r("div",{staticClass:"container",staticStyle:{"text-align":"center"}},[r("b-tooltip",{attrs:{label:"List all items",position:"is-bottom"}},[r("div",{staticClass:"item-lists is-link",class:{active:!e.selectedCategory},staticStyle:{width:"30px","margin-left":"-16px","border-bottom-color":"gray"},on:{click:function(t){e.selectedCategory=null,e.updateQueryTags()}}},[e._v(" All ")])]),e._l(e.resourceCategories,(function(t){return r("b-tooltip",{key:t.name,attrs:{label:t.description,position:"is-bottom"}},[r("div",{staticClass:"item-lists is-link",class:{active:e.selectedCategory===t},style:{"border-bottom-color":t.outline_color},on:{click:function(r){e.selectedCategory=t,e.updateQueryTags()}}},[e._v(" "+e._s(t.name)+" ")])])}))],2):e._e(),r("resource-item-selector",{attrs:{allItems:e.resourceItems,tagCategories:e.tagCategories,type:e.selectedCategory&&e.selectedCategory.type,showDisplayMode:e.screenWidth>700,searchTags:e.searchTags},on:{"selection-changed":e.updateResourceItemList,"display-mode-change":e.displayModeChanged,"tags-updated":e.updateQueryTags,"input-change":e.removePartner}}),r("br"),e.selectedItems?r("resource-item-list",{attrs:{allItems:e.selectedItems,displayMode:e.screenWidth>700?e.displayMode:"card"},on:{"show-resource-item-info":e.showResourceItemInfo,"select-tag":function(t){e.searchTags=[t]}}}):e._e(),r("br"),r("footer",{staticClass:"footer"},[e.siteConfig.footer?r("div",{staticClass:"columns is-mobile is-centered"},e._l(e.siteConfig.footer,(function(t){return r("div",{key:t.label,staticClass:"column is-one-quarter",staticStyle:{"text-align":"center"}},[r("b-tooltip",{attrs:{label:t.tooltip,position:"is-top"}},[r("a",{attrs:{href:t.url,target:"_blank"}},[r("figure",[r("img",{staticStyle:{"max-height":"55px"},attrs:{src:t.logo}}),r("figcaption",{staticClass:"hide-on-small-screen"},[e._v(" "+e._s(t.label)+" ")])])])])],1)})),0):e._e(),e.siteConfig.footnote?r("div",{staticStyle:{"text-align":"center"}},[r("p",[e._v(e._s(e.siteConfig.footnote))])]):e._e()]),r("modal",{staticStyle:{"max-width":"100%","max-height":"100%","z-index":"9999"},attrs:{name:"window-modal-dialog",resizable:!e.dialogWindowConfig.fullscreen,width:e.dialogWindowConfig.width,height:"auto",adaptive_size:e.dialogWindowConfig.adaptive_size,minWidth:200,minHeight:150,fullscreen:e.dialogWindowConfig.fullscreen,draggable:".drag-handle",scrollable:!0}},[e.selectedDialogWindow?r("div",{staticClass:"dialog-header",class:{"drag-handle":!e.isTouchDevice},on:{dblclick:function(t){return e.maximizeDialogWindow()}}},[r("div",{staticStyle:{position:"absolute",left:"2px","margin-top":"-1px"}},[r("button",{staticClass:"noselect dialog-control-button",staticStyle:{background:"#ff0000c4"},on:{click:function(t){return e.closeDialogWindow(e.selectedDialogWindow)}}},[e._v(" x ")]),e.screenWidth>700?r("button",{staticClass:"noselect dialog-control-button",staticStyle:{background:"#00cdff61"},on:{click:function(t){return e.minimizeDialogWindow()}}},[e._v(" - ")]):e._e(),e.screenWidth>700?r("button",{staticClass:"noselect dialog-control-button",staticStyle:{background:"#00cdff61"},on:{click:function(t){return e.maximizeDialogWindow()}}},[e._v(" "+e._s(e.dialogWindowConfig.fullscreen?"=":"+")+" ")]):e._e()]),r("span",{staticClass:"noselect dialog-title"},[e._v(" "+e._s(e.selectedDialogWindow.name))]),r("b-dropdown",{staticStyle:{position:"absolute",right:"1px"},attrs:{"aria-role":"list",position:"is-bottom-left"}},[r("button",{staticClass:"button",staticStyle:{background:"rgba(0, 205, 255, 0.38)",color:"white",width:"34px"},attrs:{slot:"trigger"},slot:"trigger"},[r("b-icon",{attrs:{icon:"dots-horizontal"}})],1),e._l(e.dialogWindows,(function(t){return r("b-dropdown-item",{key:t.id,attrs:{"aria-role":"listitem"},on:{click:function(r){return e.selectWindow(t)}}},[e._v(e._s(t.name))])}))],2)],1):e._e(),e._l(e.dialogWindows,(function(t){return[r("div",{directives:[{name:"show",rawName:"v-show",value:t===e.selectedDialogWindow,expression:"wdialog === selectedDialogWindow"}],key:t.window_id,staticStyle:{height:"calc(100% - 40px)",overflow:"auto"}},[r("div",{staticClass:"noselect",staticStyle:{width:"100%",height:"100%"},attrs:{id:t.window_id}})])]}))],2),r("modal",{staticStyle:{"max-width":"100%","max-height":"100%"},attrs:{name:"info-dialog",resizable:!0,minWidth:200,minHeight:150,height:"auto",width:800,fullscreen:e.infoDialogFullscreen,draggable:".drag-handle",scrollable:!0}},[r("div",{staticClass:"dialog-header",class:{"drag-handle":!e.isTouchDevice},on:{dblclick:function(t){return e.maximizeInfoWindow()}}},[r("div",{staticStyle:{position:"absolute",left:"2px","margin-top":"-1px"}},[r("button",{staticClass:"noselect dialog-control-button",staticStyle:{background:"#ff0000c4"},on:{click:function(t){return e.closeInfoWindow()}}},[e._v(" x ")]),e.screenWidth>700?r("button",{staticClass:"noselect dialog-control-button",staticStyle:{background:"#00cdff61"},on:{click:function(t){return e.maximizeInfoWindow()}}},[e._v(" "+e._s(e.infoDialogFullscreen?"=":"+")+" ")]):e._e()]),r("span",{staticClass:"noselect dialog-title"},[e._v(" "+e._s(e.infoDialogTitle))])]),r("div",{staticClass:"modal-dialog-content"},["about"===e.showInfoDialogMode?r("about",{on:{contribute:e.showUploadDialog}}):"upload"===e.showInfoDialogMode?r("upload",{attrs:{"site-config":e.siteConfig,"deposition-id":null}}):"viewer"===e.showInfoDialogMode?r("iframe",{staticStyle:{"padding-bottom":"64px",width:"100%",height:"100%"},attrs:{src:e.viewerUrl,width:"640",height:"852",frameborder:"0",marginheight:"0",marginwidth:"0"}},[e._v("Loadingâ€¦")]):"edit"===e.showInfoDialogMode?r("div",[r("upload",{attrs:{"site-config":e.siteConfig,"deposition-id":e.currentDepositionId}})],1):"markdown"===e.showInfoDialogMode?r("div",{staticClass:"markdown-container"},[r("markdown",{attrs:{content:e.infoMarkdownContent,url:e.infoMarkdownUrl}})],1):"attachments"===e.showInfoDialogMode&&e.selectedResourceItem?r("div",{staticClass:"markdown-container"},[r("attachments",{attrs:{attachments:e.selectedResourceItem.attachments,focusTarget:e.selectedResourceItem._focus}})],1):"subscribe"===e.showInfoDialogMode?r("iframe",{staticStyle:{"padding-bottom":"64px",width:"100%",height:"100%"},attrs:{src:e.siteConfig.subscribe_url,width:"640",height:"852",frameborder:"0",marginheight:"0",marginwidth:"0"}},[e._v("Loadingâ€¦")]):"item"===e.showInfoDialogMode&&e.selectedResourceItem?r("resource-item-info",{attrs:{"resource-id":e.selectedResourceItem.id}}):e._e()],1)])],1)},X=[],V=(r("a15b"),r("fb6a"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container content-wrapper"},[r("section",{staticClass:"center "},[r("b-field",{staticStyle:{"max-width":"calc(100vw - 10px)"},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}}},[r("b-taginput",{staticClass:"searchbar",attrs:{loading:e.loading,type:"is-info","allow-new":"",data:e.filteredTags,"open-on-focus":!0,autocomplete:"",ellipsis:"",icon:"magnify",placeholder:"Type a keyword and press enter"},on:{input:e.updateSelectedTags,typing:e.getFilteredTags},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.option)+" ")]}}]),model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}}),r("b-dropdown",{attrs:{"aria-role":"list",position:"is-bottom-left"}},[r("button",{staticClass:"button tags-button",attrs:{slot:"trigger"},slot:"trigger"},[r("span",[e._v("Tags")]),r("b-icon",{attrs:{icon:"menu-down"}})],1),r("div",{staticClass:"dropdown-panel",attrs:{"aria-role":"listitem"}},[r("div",{staticClass:"container",staticStyle:{"max-width":"100%"}},[r("div",{staticClass:"field"},[r("b-switch",{model:{value:e.matchingAll,callback:function(t){e.matchingAll=t},expression:"matchingAll"}},[e._v("Match: "+e._s(e.matchingAll?" All":"Any"))]),r("b-switch",{model:{value:e.freeTextMode,callback:function(t){e.freeTextMode=t},expression:"freeTextMode"}},[e._v("Free Text: "+e._s(e.freeTextMode?" Enabled":"Disabled"))])],1),e._l(e.categories.groupKeys,(function(t){return r("div",{key:t,staticClass:"column"},[e._v(" "+e._s(2===t.split(".").length?t.split(".")[1]:t)+": "),r("br"),e._l(e.categories.grouped[t],(function(t){return r("a",{key:t,staticStyle:{display:"inline-block"},on:{click:function(r){return e.addTagSelection(t)}}},[r("b-tag",{staticStyle:{cursor:"pointer"},attrs:{rounded:""}},[e._v(e._s(t))])],1)}))],2)})),r("div",{staticClass:"column"},[Object.keys(e.categories.grouped).length>0?r("span",[e._v("other: "),r("br")]):e._e(),e._l(e.categories.other,(function(t){return r("a",{key:t,staticStyle:{display:"inline-block"},on:{click:function(r){return e.addTagSelection(t)}}},[r("b-tag",{staticStyle:{cursor:"pointer"},attrs:{rounded:""}},[e._v(e._s(t))])],1)}))],2)],2)])]),e.showDisplayMode?r("b-field",{staticClass:"display-mode-btn"},[r("p",{staticClass:"control"},[r("b-tooltip",{attrs:{label:"Display mode: list",position:"is-top"}},[r("button",{staticClass:"button",class:{"is-primary":"list"===e.displayMode},staticStyle:{top:"1px",height:"34px"},on:{click:function(t){return e.switchDisplayMode("list")}}},[r("b-icon",{attrs:{icon:"format-list-bulleted"}})],1)])],1),r("p",{staticClass:"control"},[r("b-tooltip",{attrs:{label:"Display mode: card",position:"is-top"}},[r("button",{staticClass:"button",class:{"is-primary":"card"===e.displayMode},staticStyle:{top:"1px",height:"34px"},on:{click:function(t){return e.switchDisplayMode("card")}}},[r("b-icon",{attrs:{icon:"view-grid"}})],1)])],1)]):e._e()],1),r("b-field")],1)])}),J=[],H=(r("a623"),r("45fc"),r("498a"),{name:"ResourceItemSelector",props:{allItems:{type:Array,default:null},type:{type:String,default:null},tagCategories:{type:Object,default:null},showDisplayMode:{type:Boolean,default:!1},searchTags:{type:Array,default:null}},data:function(){return{selectedItems:[],selectedTags:[],filteredTags:[],loading:!1,matchingAll:!0,freeTextMode:!0,displayMode:"card"}},watch:{type:function(e){this.allItems&&(this.type=e,this.applySearch(this.selectedTags))},selectedTags:function(e){this.applySearch(e)},allItems:function(){this.applySearch(this.selectedTags)},searchTags:function(e){var t=this;if(e){var r=e&&e.length==this.selectedTags.length&&e.every((function(e,r){return e===t.selectedTags[r]}));r||(e=e.filter((function(e){return e&&""!=e.trim()})),this.selectedTags=Array.from(new Set(e)))}else this.selectedTags=[]}},mounted:function(){this.filteredTags=this.fullLabelList},computed:{categories:function(){if(!this.tagCategories)return{grouped:{},other:this.fullLabelList};var e,t={},r=[],a=this.selectedTags.map((function(e){return e.toLowerCase()})),n=Object(l["a"])(this.fullLabelList);try{for(n.s();!(e=n.n()).done;){var s=e.value;if(!(a.indexOf(s.toLowerCase())>=0)){for(var o=!1,i=0,c=Object.keys(this.tagCategories);i<c.length;i++){var u,_=c[i],d=Object(l["a"])(this.tagCategories[_]);try{for(d.s();!(u=d.n()).done;){var p=u.value;if(p.toLowerCase()===s.toLowerCase()){t[_]||(t[_]=[]),t[_].push(p),o=!0;break}}}catch(fr){d.e(fr)}finally{d.f()}}o||r.push(s)}}}catch(fr){n.e(fr)}finally{n.f()}return{grouped:t,groupKeys:Object.keys(t).sort(),other:r}},fullLabelList:function(){var e=[],t=this.selectedItems||this.allItems;if(t){var r,a=this.selectedCategory&&this.selectedCategory.type,n=a?t.filter((function(e){return e.type===a})):t,s=Object(l["a"])(n);try{for(s.s();!(r=s.n()).done;){var o=r.value;o.allLabels&&o.allLabels.forEach((function(t){-1===e.indexOf(t)&&e.push(t.toLowerCase().replace(/ /g,"-"))}))}}catch(fr){s.e(fr)}finally{s.f()}}return e.sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1})),Array.from(new Set(e))}},methods:{applySearch:function(e){var t=this;this.allItems&&(this.$emit("tags-updated",e),this.loading=!0,Object(_["d"])((function(){var r,a=t.type?t.allItems.filter((function(e){return e.type===t.type})):t.allItems;if(e.length<=0)r=a;else{var n=e.filter((function(e){return t.fullLabelList.indexOf(e.toLowerCase())>=0}));r=a.filter((function(r){var a;a=t.matchingAll?n.length>0&&n.every((function(e){return r.allLabels.includes(e.toLowerCase())})):n.length>0&&n.some((function(e){return r.allLabels.includes(e.toLowerCase())}));var s=function(e){return e=e.replace(/-/g,"").toLowerCase(),r.name.replace(/-/g,"").toLowerCase().includes(e)||r.description&&r.description.replace(/-/g,"").toLowerCase().split(/[ .:;?!~,`"&|()<>{}[\]\r\n/\\]+/).includes(e)||r.authors&&r.authors.some((function(t){return(t.name||t).toLowerCase().includes(e)}))||r.apps&&r.apps.some((function(t){return t.name&&t.name.toLowerCase().includes(e)}))};return(!t.type||r.type===t.type)&&(a||t.freeTextMode&&e.every(s))}))}t.$emit("selection-changed",r),t.selectedItems=r,t.loading=!1,t.$forceUpdate()}),400)())},switchDisplayMode:function(e){this.displayMode!==e&&(this.displayMode=e,this.$emit("display-mode-change",e))},updateSelectedTags:function(){var e=this;this.$emit("input-change"),this.filteredTags=this.fullLabelList.filter((function(t){return e.selectedTags.indexOf(t)<0}))},getFilteredTags:function(e){this.filteredTags=this.fullLabelList.filter((function(t){return t.toLowerCase().indexOf(e.toLowerCase())>=0}))},addTagSelection:function(e){this.selectedTags.indexOf(e)<0&&this.selectedTags.push(e)}}}),G=H,Q=(r("970a"),Object(K["a"])(G,V,J,!1,null,"3b5b4ef4",null)),ee=Q.exports,te=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"resource-item-list"},[r("div",{staticClass:"container content-wrapper"},["card"===e.displayMode?r("div",{staticClass:"columns is-multiline"},[e._l(e.allItems.slice((e.currentPage-1)*e.itemsPerPage,e.currentPage*e.itemsPerPage),(function(t){return r("div",{key:t.id,staticClass:"column is-4-desktop is-3-widescreen is-half-tablet resource-card"},[r("resource-item-card",{attrs:{resourceItem:t},on:{"show-info":e.showResourceItemInfo,"select-tag":function(t){return e.$emit("select-tag",t)}}})],1)})),e.allItems&&0===e.allItems.length?r("span",{staticClass:"column",staticStyle:{"text-align":"center"}},[e._v("The list is empty.")]):e._e()],2):r("b-table",{attrs:{data:e.allItems,detailed:!0,"show-detail-icon":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e.siteConfig.table_view.columns.includes("name")?r("b-table-column",{attrs:{label:"Name",width:"20",field:"name",sortable:""}},[r("a",{on:{click:function(r){return e.showResourceItemInfo(t.row)}}},[e._v(" "+e._s(t.row.name)+" ")]),r("p",[e._v(" "+e._s(t.row.description.slice(0,100)+(t.row.description.length>100?"...":""))+" ")])]):e._e(),e.siteConfig.table_view.columns.includes("authors")?r("b-table-column",{attrs:{label:"Author(s)",width:"20",sortable:"",field:"authors"}},e._l(t.row.authors,(function(t){return r("b-tooltip",{key:t.name,attrs:{label:t.affiliation,position:"is-bottom"}},[r("span",[e._v(e._s(t.name))])])})),1):e._e(),e.siteConfig.table_view.columns.includes("badges")?r("b-table-column",{attrs:{label:"Badges",width:"50",field:"badges",sortable:""}},[t.row.badges?r("div",{staticClass:"badges"},e._l(t.row.badges,(function(t){return r("a",{key:t.label,staticClass:"badge",attrs:{href:t.url,target:"_blank"},on:{click:function(e){!t.url&&t.run&&t.run()}}},[t.icon?r("img",{attrs:{alt:t.label,src:t.icon}}):r("b-taglist",{attrs:{attached:"",rounded:""}},[r("b-tag",{attrs:{type:t.label_type||"is-dark"}},[e._v(e._s(t.label))]),t.ext?r("b-tag",{attrs:{type:t.ext_type||"is-success"}},[e._v(e._s(t.ext))]):e._e()],1)],1)})),0):e._e()]):e._e(),e.siteConfig.table_view.columns.includes("apps")?r("b-table-column",{attrs:{label:"Apps",width:"30",field:"apps",sortable:""}},[r("app-icons",{attrs:{apps:t.row.apps}})],1):e._e()]}},{key:"detail",fn:function(t){return[r("resource-item-card",{attrs:{resourceItem:t.row},on:{"show-info":e.showResourceItemInfo,"select-tag":function(t){return e.$emit("select-tag",t)}}})]}}])}),r("b-pagination",{staticClass:"resource-pagination",attrs:{total:e.totalItems,current:e.currentPage,"range-before":3,"range-after":1,"per-page":e.itemsPerPage,"icon-prev":"arrow-left","icon-next":"arrow-right","aria-next-label":"Next page","aria-previous-label":"Previous page","aria-page-label":"Page","aria-current-label":"Current page"},on:{"update:current":function(t){e.currentPage=t}}})],1)])},re=[],ae=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.apps?r("div",{staticClass:"app-icons"},[e._l(e.apps,(function(t){return[r("b-tooltip",{key:t.name,class:{"hover-show":t.show_on_hover&&e.enableHover},attrs:{label:t.name,position:"is-bottom"}},[r("b-button",{staticClass:"is-small action-btn",attrs:{rounded:"",tag:"a",href:t.url,target:"_blank"},on:{click:function(e){!t.url&&t.run&&t.run()}}},[t.icon&&"extension"!==t.icon?t.icon.startsWith("http")?r("img",{staticClass:"app-icon",attrs:{src:t.icon,alt:t.name}}):r("b-icon",{attrs:{icon:t.icon,size:"is-small"}}):r("b-icon",{attrs:{icon:"puzzle",size:"is-small"}})],1)],1)]}))],2):e._e()},ne=[],se={name:"AppIcons",props:{apps:{type:Array,default:null},enableHover:{type:Boolean,default:!1}}},oe=se,ie=(r("b35e"),Object(K["a"])(oe,ae,ne,!1,null,"3c22306a",null)),ce=ie.exports,le=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"resource-item-card"},[r("div",{staticClass:"card is-shady",style:{"box-shadow":e.boxShadow}},[r("div",{staticClass:"card-image"},[e.resourceItem.covers&&e.resourceItem.covers.length>0?r("b-carousel",{attrs:{indicator:e.resourceItem.covers.length>1,arrow:e.resourceItem.covers.length>1,autoplay:!1,"pause-info":!1}},e._l(e.resourceItem.covers,(function(t){return r("b-carousel-item",{key:t,staticClass:"carousel-image"},[r("img",{staticClass:"cover-image",attrs:{loading:"lazy",src:t,alt:e.resourceItem.name}})])})),1):r("img",{staticClass:"cover-image",staticStyle:{"background-color":"black",width:"100%",height:"160px"},attrs:{loading:"lazy"}})],1),r("div",{staticClass:"card-content"},[r("div",{staticClass:"content"},[r("h4",{staticClass:"resource-item-title truncated",on:{click:e.showResourceItemInfo}},["img"===e.icon.type?r("img",{staticClass:"item-icon",staticStyle:{"border-radius":"4px",background:"#ffffffd0"},attrs:{src:e.icon.src}}):"animal"===e.icon.type?r("img",{staticClass:"item-icon",staticStyle:{"border-radius":"50%",background:"#167cf0b8"},attrs:{src:"/static/anonymousAnimals/"+e.icon.src+".png"}}):r("b-icon",{staticClass:"item-icon",attrs:{icon:e.icon.src}}),e._v(" "+e._s(e.resourceItem.name)+" ")],1),r("div",{staticClass:"buttons floating-buttons"},[r("app-icons",{attrs:{apps:e.resourceItem.apps,enableHover:!e.isTouchDevice}})],1),r("span",{staticClass:"authors",attrs:{title:e.affil(e.resourceItem.authors)}},[e._v(" "+e._s(e.resourceItem.authors&&e.resourceItem.authors.length>0?"by "+e.etAl(e.resourceItem.authors):"")+" ")]),e.resourceItem.description?r("p",{staticClass:"resource-item-description"},[e._v(" "+e._s(e.resourceItem.description.slice(0,60)+(e.resourceItem.description.length>60?"...":""))+" ")]):e._e(),r("span",{staticStyle:{"margin-top":"3px",display:"block"}},[e._l(e.resourceItem.tags.slice(0,4),(function(t){return r("span",{key:t},[r("b-tag",{staticStyle:{cursor:"pointer"},attrs:{rounded:""},nativeOn:{click:function(r){return e.selectTag(t)}}},[e._v(e._s(t))])],1)})),e.resourceItem.tags.length>4?r("span",[r("b-tag",{staticStyle:{cursor:"pointer"},attrs:{rounded:""},nativeOn:{click:function(t){return e.showResourceItemInfo(t)}}},[e._v("...")])],1):e._e()],2),r("badges",{staticClass:"badges",attrs:{badges:e.resourceItem.badges}})],1)])])])},ue=[],_e=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.badges?r("div",{staticClass:"badges"},e._l(e.badges,(function(t){return r("a",{key:t.label,staticClass:"badge",attrs:{href:t.url,target:"_blank"},on:{click:function(e){!t.url&&t.run&&t.run()}}},[t.icon?r("img",{staticClass:"badge-img",attrs:{alt:t.label,src:t.icon}}):r("b-taglist",{attrs:{attached:"",rounded:""}},[r("b-tag",{attrs:{type:t.label_type||"is-dark"}},[e._v(e._s(t.label))]),void 0!==t.ext?r("b-tag",{attrs:{type:t.ext_type||"is-success"}},[e._v(e._s(t.ext))]):e._e()],1)],1)})),0):e._e()},de=[],pe={name:"Badges",props:{badges:{type:Array,default:null}}},fe=pe,he=(r("409f"),Object(K["a"])(fe,_e,de,!1,null,"37be7c04",null)),me=he.exports,ge={},be=Object(l["a"])(d.resource_categories);try{for(be.s();!(N=be.n()).done;){var ve=N.value;ge[ve.type]=ve.outline_color}}catch(fr){be.e(fr)}finally{be.f()}var ye=function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}(),we={name:"ModelCard",props:{resourceItem:{type:Object,default:null}},data:function(){return{isTouchDevice:ye}},components:{badges:me,"app-icons":ce},computed:{boxShadow:function(){var e=ge[this.resourceItem.type]||"rgba(0,0,0,.2)";return"0 3px 1px -2px ".concat(e,", 0 2px 2px 0 ").concat(e,", 0 1px 5px 0 rgba(0,0,0,.12)")},icon:function(){return this.resourceItem.icon?{type:"material",src:this.resourceItem.icon}:{}}},methods:{etAl:function(e){return e=e.map((function(e){return e.name.split(";")[0]})),e.length<3?e.join(", "):e.slice(0,3).join(", ")+" et al."},affil:function(e){var t=e.map((function(e){return e.affiliation}));return Array.from(new Set(t)).join("; ")},showResourceItemInfo:function(){this.$emit("show-info",this.resourceItem)},selectTag:function(e){this.$emit("select-tag",e)}}},ke=we,xe=(r("968b"),Object(K["a"])(ke,le,ue,!1,null,"119a5379",null)),Oe=xe.exports,Ee=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);n["default"].component("label-selector",{props:["all-labels"],template:document.getElementById("label-selector")});var Ce={name:"ResourceItemList",components:{"resource-item-card":Oe,"app-icons":ce},props:{allItems:{type:Array,default:null},displayMode:{type:String,default:"card"}},computed:{totalItems:function(){return this.allItems?this.allItems.length:0},filteredItems:function(){var e=this,t=this.allItems.filter((function(e){return e.cover_image})),r=t.concat(this.allItems.filter((function(e){return!e.cover_image})));return r.filter((function(t){return e.filters.every((function(e){return t.allLabels.includes(e)}))}))}},data:function(){return{isSafari:Ee,siteConfig:d,currentPage:1,itemsPerPage:16}},mounted:function(){},beforeDestroy:function(){},methods:{showResourceItemInfo:function(e){this.$emit("show-resource-item-info",e)}}},Ie=Ce,De=(r("f9e7"),Object(K["a"])(Ie,te,re,!1,null,"c6579262",null)),Me=De.exports,Pe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.resourceItem?r("div",{staticClass:"resource-item-info width-limited"},[e.resourceItem.apps?r("section",{staticStyle:{"margin-bottom":"10px"}},[r("app-icons",{attrs:{apps:e.resourceItem.apps}}),e._v(" "),r("badges",{attrs:{badges:e.resourceItem.badges}})],1):e._e(),r("section",{staticStyle:{"text-align":"center"}},[e.resourceItem.covers&&e.resourceItem.covers.length>0?r("b-carousel",{staticStyle:{"max-width":"512px"},attrs:{indicator:e.resourceItem.covers.length>1,arrow:e.resourceItem.covers.length>1,"pause-info":!1}},e._l(e.resourceItem.covers,(function(t){return r("b-carousel-item",{key:t},[r("figure",{staticClass:"image is-16by9"},[r("img",{staticClass:"cover-image",attrs:{loading:"lazy",src:t,alt:e.resourceItem.name,"data-target":"modal-image2"}})])])})),1):e._e()],1),r("span",{staticStyle:{"margin-top":"3px",display:"block"}},e._l(e.resourceItem.tags,(function(t){return r("span",{key:t},[r("b-tag",{staticStyle:{cursor:"pointer"},attrs:{rounded:""}},[e._v(e._s(t))])],1)})),0),e.resourceItem.description?r("p",{staticClass:"description"},[e._v(" "+e._s(e.resourceItem.description.slice(0,e.maxDescriptionLetters))+" "),e.resourceItem.description.length>e.maxDescriptionLetters?r("a",{on:{click:function(t){e.maxDescriptionLetters=e.resourceItem.description.length}}},[e._v("...show all.")]):e._e()]):e._e(),e.resourceItem.authors&&e.resourceItem.authors.length>0?r("p",{staticClass:"text-info"},[e._v(" "+e._s(e.resourceItem.authors.length>1?"Authors: ":"Author: ")+" "),e._l(e.resourceItem.authors,(function(t){return r("b-tooltip",{key:t.name,attrs:{label:t.affiliation,position:"is-bottom"}},[r("span",{staticClass:"text-info"},[e._v(e._s(t.name)+" ")])])}))],2):e._e(),e.resourceItem.uploaded_by?r("p",{staticClass:"text-info"},[e._v(" Uploaded by: "+e._s(e.resourceItem.uploaded_by)+" ")]):e._e(),e.resourceItem.contact_email?r("p",{staticClass:"text-info"},[e._v(" Contact Email: "),r("a",{attrs:{href:"mailto: "+e.resourceItem.contact_email+"?subject=About "+e.resourceItem.name+" (ShareLoc.XYZ)"}},[e._v(e._s(e.resourceItem.contact_email))])]):e._e(),!e.showAttachments&&e.resourceItem.attachments?r("p",{staticClass:"text-info"},[r("a",{staticClass:"tag is-primary",on:{click:function(t){e.showAttachments=!0}}},[e._v("+ click here to list the samples in the dataset")])]):e._e(),r("br"),e.showAttachments?r("attachments",{attrs:{attachments:e.resourceItem.attachments,focusTarget:e.resourceItem._focus}}):e._e(),r("div",{staticClass:"markdown-body width-limited"},[e.resourceItem.docs?r("h1",{staticStyle:{"margin-top":"20px"}},[e._v("Documentation")]):e._e(),e.resourceItem.docs?r("markdown",{attrs:{baseUrl:e.resourceItem.baseUrl,content:e.resourceItem.docs}}):e._e(),r("br"),e.formatedCitation?r("h3",{attrs:{id:"citation"}},[e._v("How to cite")]):e._e(),e.formatedCitation?r("ul",{staticClass:"citation"},e._l(e.formatedCitation,(function(t){return r("li",{key:t.text},[e._v(" "+e._s(t.text)+" "),t.url?r("a",{attrs:{href:t.url,target:"_blank"}},[e._v("["+e._s(t.url_text)+"]")]):e._e()])})),0):e._e()],1)],1):r("h2",[e._v("Resource not found: "+e._s(e.resourceId))])},Re=[],je=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"attachments"},[e._l(e.normalizedAttachments,(function(t,a){return[t?r("h2",{key:a+"_title",staticStyle:{"font-size":"2rem","font-weight":"600","margin-top":"24px","margin-bottom":"16px","text-transform":"capitalize"},attrs:{id:a}},[e._v(" "+e._s(a)+" ")]):e._e(),t?r("b-table",{key:a+"_table",attrs:{data:e.convert2Array(t),detailed:!!t.type,"show-detail-icon":!!t.type},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.availableColumns,(function(a){return r("b-table-column",{key:a.field,attrs:{field:a.field,label:a.label,width:a.width||40,sortable:a.sortable}},[t.row[a.field]?["files"===a.type?r("div",[r("ul",e._l(t.row[a.field]||[],(function(n,s){return r("li",{key:s,staticStyle:{"list-style":"disc"}},[r("a",{class:a.class,attrs:{href:n.download_url,download:t.row["name"]+n.name,target:"_blank"}},[e._v(" "+e._s(n.name)+" ")]),n.preview_url?r("span",[e._v("("),r("a",{class:a.class,attrs:{href:n.preview_url,target:"_blank"}},[e._v(" preview ")]),e._v(")")]):e._e(),n.csv?r("span",[e._v("("),e._l(n.csv,(function(t){return r("a",{key:t.name,class:a.class,attrs:{href:t.url,target:"_blank"}},[e._v(" "+e._s(t.name)+" ")])})),e._v(")")],2):e._e()])})),0)]):"thumbnails"===a.type?r("div",e._l(t.row[a.field]||[],(function(e,t){return r("div",{key:t,staticClass:"item"},[r("img",{staticClass:"image",attrs:{loading:"lazy",src:e.image,alt:"Screenshot"}})])})),0):"url"===a.type?r("a",{class:a.class,attrs:{href:t.row[a.field],target:"_blank"}},[e._v(" "+e._s(a.text)+" ")]):r("span",{class:a.class},[e._v(" "+e._s(t.row[a.field]&&t.row[a.field].slice(0,a.max_length)+(t.row[a.field].length>a.max_length?"...":""))+" ")])]:e._e()],2)}))}},{key:"detail",fn:function(e){return[r("resource-item-card",{attrs:{resourceItem:e.row}})]}}],null,!0)}):e._e()]}))],2)},Le=[],Te=r("53ca"),Se={name:"Attachments",props:{attachments:{type:Object,default:null},focusTarget:{type:String,default:null}},components:{"resource-item-card":Oe},data:function(){return{siteConfig:d,columns:[]}},mounted:function(){var e=this;setTimeout((function(){e.focus(e.focusTarget)}),100)},watch:{focusTarget:function(e){this.focus(e)}},computed:{availableColumns:function(){var e=this;return d.attachment_table.columns.filter((function(t){return e.columns.includes(t.field)}))},normalizedAttachments:function(){for(var e={},t=0,r=Object.keys(this.attachments);t<r.length;t++){var a=r[t],n=this.attachments[a];if("object"===Object(Te["a"])(n)){for(var s=[],o=0,i=Object.keys(n);o<i.length;o++){var c=i[o],l=Object.assign({},n[c]);l.name=l.name||c,s.push(l)}e[a]=s}else e[a]=n}return e}},methods:{focus:function(e){if(e){var t=document.getElementById(e);t&&t.scrollIntoView()}},convert2Array:function(e){var t=[];if(this.columns=t,e instanceof Object&&e.constructor===Object){for(var r=[],a=0,n=Object.keys(e);a<n.length;a++){var s=n[a];if(e[s]instanceof Object){e[s]["id"]=s,r.push(e[s]);for(var o=0,i=Object.keys(e[s]);o<i.length;o++){var c=i[o];t.includes(c)||t.push(c)}}else{var l=e[s].split("/"),u=l[l.length-1]||"undefined";r.push({download_url:e[s],name:u}),t.includes("download_url")||t.push("download_url"),t.includes("name")||t.push("name")}}return r}if(Array.isArray(e)){for(var _=[],d=0;d<e.length;d++)if(e[d]instanceof Object){e[d]["id"]=d,_.push(e[d]);for(var p=0,f=Object.keys(e[d]);p<f.length;p++){var h=f[p];t.includes(h)||t.push(h)}}else{var m=e[d].split("/"),g=m[m.length-1]||m[m.length-2]||"undefined";_.push({download_url:e[d],name:g}),t.includes("download_url")||t.push("download_url"),t.includes("name")||t.push("name")}return _}return console.warn("Failed to convert: ",e),[]}}},Ue=Se,Ae=(r("d479"),Object(K["a"])(Ue,je,Le,!1,null,"772bbdbc",null)),We=Ae.exports,Be=r("e6e0"),Fe={name:"ResourceItemInfo",props:["resourceId"],components:{markdown:Be["a"],badges:me,attachments:We,"app-icons":ce},data:function(){return{resourceItem:null,maxDescriptionLetters:100,showSource:!1,showAttachments:!1}},mounted:function(){this.init()},computed:Object(a["a"])({formatedCitation:function(){var e=this.resourceItem.cite;if(this.resourceItem.cite&&!Array.isArray(this.resourceItem.cite)&&(e=[this.resourceItem.cite]),!e||e.length<=0)return this.resourceItem.doi?[{text:"DOI: "+this.resourceItem.doi}]:null;var t,r=[],a=Object(l["a"])(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;if("string"===typeof n)r.push({text:n});else{var s=n.url,o="link";n.doi&&(s=n.doi.startsWith("http")?n.doi:"https://doi.org/"+n.doi,o="doi"),r.push({text:n.text,url:s,url_text:o})}}}catch(fr){a.e(fr)}finally{a.f()}return r}},Object(c["b"])({siteConfig:function(e){return e.siteConfig},loadedUrl:function(e){return e.loadedUrl},resourceItems:function(e){return e.resourceItems}})),methods:{init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.loadedUrl){t.next=5;break}return r=e.siteConfig.rdf_root_repo,a=e.siteConfig.manifest_url,t.next=5,e.$store.dispatch("fetchResourceItems",{repo:r,manifest_url:a});case 5:if(n=e.resourceItems.filter((function(t){return t.id===e.resourceId}))[0],n){t.next=9;break}throw alert("Item not found: "+e.resourceId),new Error("Item not found: "+e.resourceId);case 9:e.resourceItem=n,s=function(){if(e.resourceItem._focus){var t=document.getElementById(e.resourceItem._focus);t&&(t.parentNode.scrollTop=t.offsetTop-40)}},e.resourceItem.documentation&&e.getDocs(e.resourceItem).then(s);case 12:case"end":return t.stop()}}),t)})))()},getDocs:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.docs="@loading...",r.prev=1,a=e.documentation.startsWith("http")?e.documentation:new URL(e.documentation,e.root_url).href,a.includes("github.")&&(a=a+"?"+Object(_["h"])()),r.next=6,fetch(a);case 6:if(n=r.sent,200!=n.status){r.next=15;break}return r.next=10,n.text();case 10:s=r.sent,t.resourceItem.documentation.startsWith("http")?(c=t.resourceItem.documentation.split("/"),o=c.slice(0,c.length-1).join("/")):(i=(t.resourceItem.root_url+"/"+t.resourceItem.documentation).split("/"),o=i.slice(0,i.length-1).join("/")),e.documentation.endsWith(".md")?(e.baseUrl=o,e.docs=s):e.documentation&&(e.docs="### [Documentation](".concat(e.documentation,")")),r.next=16;break;case 15:e.docs=null;case 16:t.$forceUpdate(),r.next=23;break;case 19:r.prev=19,r.t0=r["catch"](1),e.docs=null,t.$forceUpdate();case 23:case"end":return r.stop()}}),r,null,[[1,19]])})))()}}},Ke=Fe,qe=(r("05ff"),Object(K["a"])(Ke,Pe,Re,!1,null,"e39a61ea",null)),ze=qe.exports,$e=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"upload"},[r("b-notification",{attrs:{type:"is-info","has-icon":"","aria-close-label":"Close notification",role:"alert"}},[e._v(" You are using the PRODUCTION mode, this means files will be uploaded to Zenodo (https://zenodo.org) and they will be permanently stored. If you want to test the upload feature, please "),r("a",{on:{click:function(t){return e.switchToSandbox()}}},[e._v("switch to the sanbox mode")]),e._v(". ")]),r("b-steps",{staticClass:"width-limited",staticStyle:{"margin-top":"20px"},attrs:{position:"left","has-navigation":!1,"label-position":"right"},model:{value:e.stepIndex,callback:function(t){e.stepIndex=t},expression:"stepIndex"}},[r("b-step-item",{attrs:{disabled:e.rdfYaml,label:"Start",icon:"file"}},[e.imjoy?r("b-button",{staticClass:"button is-fullwidth",staticStyle:{"text-transform":"none"},attrs:{expanded:""},on:{click:e.gettingStarted}},[e._v("New to ShareLoc.XYZ? Watch the Step-by-step Guide")]):e._e(),r("br"),e.server?r("b-field",{attrs:{label:"You have already logged in via hypha",message:"ShareLoc.XYZ uses hypha as storage service, you can now upload files to hypha on your behalf.",expanded:""}},[r("b-button",{staticClass:"button is-small",staticStyle:{"text-transform":"none"},attrs:{"icon-left":"logout"},on:{click:function(t){return e.logout()}}},[e._v("Logout")])],1):r("b-field",{attrs:{label:"Please login or sign to upload",message:"ShareLoc.XYZ uses hypha as storage service, you will need to sign up or login to hypha, and allow ShareLoc.XYZ to upload files to hypha on your behalf.",expanded:""}},[r("b-button",{staticClass:"button is-fullwidth is-primary",staticStyle:{"text-transform":"none"},attrs:{expanded:"","icon-left":"login"},on:{click:function(t){return e.login()}}},[e._v("Login to Upload")])],1),e.server?r("b-field",{attrs:{label:"Option 1: Create a new deposit",expanded:"",message:"With this option, you can upload a dataset or application to ShareLoc (via Zenodo), please make sure you have prepared a set of files. Also note that each dataset can contain files with the total size up to 50GB, if you have more than that, you should either split the files into several deposits or contact Zenodo to increase the quota."}},[r("b-button",{staticClass:"button is-fullwidth",staticStyle:{"text-transform":"none"},attrs:{expanded:"",disabled:!e.server},on:{click:e.startUpload}},[e._v("Start Upload")])],1):e._e(),e._e(),e._e(),r("br"),r("b-notification",{attrs:{"aria-close-label":"Close notification"}},[r("h1",[e._v(" You can also create an application card for your software tool! ")]),r("p",[e._v(" If you developed a software tool for facilitating data acquisiton or analysis of SMLM data, please consider adding an `application` card to ShareLoc.XYZ so people who used your tool can link their datasets to your tool. You can also make an "),r("a",{attrs:{target:"_blank",href:"https://imjoy.io"}},[e._v("ImJoy")]),e._v(" plugin for your tool so users can directly run it from within ShareLoc. For detailed instructions on how to contribute an application, please "),r("a",{attrs:{target:"_blank",href:"https://github.com/imodpasteur/ShareLoc.XYZ/blob/main/docs/contribute-applications.md"}},[e._v("read here")]),e._v(". ")])])],1),r("b-step-item",{attrs:{label:"Edit",icon:"pencil",disabled:!e.rdfYaml}},[1==e.stepIndex?r("section",[r("upload-form",{attrs:{"init-rdf":e.rdf},on:{submit:e.submitRDF}})],1):e._e()]),r("b-step-item",{attrs:{label:"Upload",icon:"upload"}},[e.rdfYaml?r("b-field",{staticStyle:{height:"260px",overflow:"auto"},attrs:{label:"Upload Summary"}},[e.rdfYaml?r("markdown",{attrs:{baseUrl:"",content:e.formatedModelYaml}}):e._e()],1):e._e(),e.editedFiles?r("b-field",{attrs:{label:"Files",message:"These files will be uploaded or updated"}},[r("b-taglist",{attrs:{attached:"",rounded:""}},e._l(e.editedFiles,(function(t){return r("b-tag",{key:t.sampleName+"/"+t.name,attrs:{rounded:""}},[e._v(e._s((t.sampleName?t.sampleName+"/":"")+t.name))])})),1)],1):e._e(),r("br"),e.similarDeposits&&e.similarDeposits.length>0?r("div",[r("label",{staticClass:"label"},[e._v("Similar Existing Items")]),r("p",[e._v(" The following published deposit(s) are similar to yours (matched by name), please make sure you are using distinctive names to avoid confusion to the users. ")]),e._l(e.similarDeposits,(function(t){return r("b-notification",{key:t.id,attrs:{type:t.name===e.rdf.name?"is-danger":null,"aria-close-label":"Close notification"}},[r("h1",[r("a",{attrs:{href:t.config._deposit.links.html,target:"_blank"}},[e._v(e._s(t.name))])]),r("p",[e._v(e._s(t.description.slice(0,200)))]),r("p",[e._v(" Authors: "+e._s(t.authors&&t.authors.map((function(e){return e.name.split(";")[0]})).join(","))+" ")]),r("p",[e._v("Uploaded: "+e._s(t.config._deposit.updated))]),r("br"),r("div",{staticClass:"columns"},[e.userId&&t.owners&&t.owners.includes(e.userId)?r("b-button",{staticClass:"column button is-primary is-light is-fullwidth",attrs:{expanded:"","icon-left":"autorenew"},on:{click:function(r){return e.createOrUpdateDeposit(t.config._deposit.id,!1)}}},[r("span",[e._v("Update as a new version")])]):e._e()],1)])})),r("b-button",{staticClass:"button is-fullwidth",class:{"is-primary":e.sameNameDeposits&&e.sameNameDeposits.length>0},staticStyle:{"text-transform":"none"},attrs:{expanded:"","icon-left":"arrow-left"},on:{click:function(t){e.stepIndex=1}}},[e._v("Go back to rename")])],2):e._e(),r("br"),e.uploadStatus?r("p",[e._v(e._s(e.uploadStatus))]):e._e(),e.uploadProgress?r("b-progress",{attrs:{type:"is-primary",value:e.uploadProgress,size:"is-small",expanded:""}}):e._e(),r("div",{staticClass:"columns"},[e.client&&e.editedFiles?r("div",{staticClass:"column"},[r("b-button",{staticClass:"button is-primary is-light is-fullwidth",attrs:{disabled:e.uploadProgress||e.sameNameDeposits&&e.sameNameDeposits.length>0,expanded:"","icon-left":"plus"},on:{click:function(t){return e.createOrUpdateDeposit()}}},[r("span",[e._v("Upload as new deposit")])])],1):e._e(),e.client&&e.editedFiles&&e.depositId?r("div",{staticClass:"column"},[r("b-button",{staticClass:"button is-primary is-light is-fullwidth",attrs:{disabled:e.uploadProgress,expanded:"","icon-left":"autorenew"},on:{click:function(t){return e.createOrUpdateDeposit(e.depositId,!1)}}},[r("span",[e._v("Add new version to deposit")])])],1):e._e()])],1),r("b-step-item",{attrs:{label:"Publish",icon:"share-variant",disabled:""}},[e.publishedUrl?r("b-notification",{attrs:{type:"is-success","has-icon":"","aria-close-label":"Close notification"}},[r("h1",[e._v("Published on Zenodo")]),r("h2",[e._v("DOI: "+e._s(e.publishedDOI))]),r("h2",[r("a",{attrs:{href:e.publishedUrl,target:"_blank"}},[e._v(e._s(e.publishedUrl))])]),r("p",[e._v(" Note: Newly uploaded item may not appear immediately in the resource list. ")]),e.requestedJoinCommunity?r("p",[e._v(" To be listed as part of the verified ShareLoc.XYZ community list, a notification will be sent to the admin team aand we will review request soon. ")]):e._e()]):e.prereserveDOI?r("b-notification",{attrs:{"has-icon":"","aria-close-label":"Close notification"}},[r("h1",[e._v("Ready to publish")]),r("h2",[e._v("Preserved DOI: "+e._s(e.prereserveDOI.doi))]),r("h2",[e._v(" You can also review and add additional information on Zenodo: "),r("a",{attrs:{href:e.prereserveUrl,target:"_blank"}},[e._v(e._s(e.prereserveUrl))])]),r("p",[e._v(" Note: Please check carefully before publishing. It is generally not possible to remove items after they have been published. Changes will be added as a new version, but will not erase the previous version. ")])]):e._e(),"update"===e.uploadMode?r("b-notification",{attrs:{"has-icon":"",type:"is-info","aria-close-label":"Close notification"}},[r("p",[e._v(" Note: After publishing the updated deposit, you may see the item disappear from the website, this is normal because Zenodo need some time to index the new version. It should combe back in a while. ")])]):e._e(),e.server&&e.uploaded&&!e.publishedUrl?r("b-button",{staticClass:"button is-primary is-fullwidth",attrs:{expanded:""},on:{click:function(t){return e.publishDeposition()}}},[r("b-icon",{attrs:{icon:"upload"}}),r("span",[e._v("Publish")])],1):e._e()],1)],1),r("section",{staticStyle:{padding:"10px"}})],1)},Ne=[],Ye=(r("466d"),r("651e")),Ze=r.n(Ye),Xe=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("label",{staticClass:"label",attrs:{for:e.item.label}},[e._v(" "+e._s(e.item.label)+" "),r("span",{staticClass:"helpLabel has-text-grey-light is-size-7 is-italic",staticStyle:{"margin-left":".5rem","font-weight":"400"}},[e._v(e._s(e.item.help))]),!1!==e.item.isRequired?r("sup",{staticClass:"has-text-grey-light is-size-7"},[e._v("*")]):e._e()]),r("div",{staticClass:"control"},[r("b-taginput",{attrs:{id:e.item.label,data:e.filteredTags,"allow-new":!1!==e.item.allow_new,"open-on-focus":e.item.options&&e.item.options.length>0,autocomplete:"",icon:e.item.icon||"label",placeholder:e.item.placeholder},on:{input:function(t){return e.$emit("input",e.value)},typing:e.getFilteredTags},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),e.error?r("p",{staticClass:"help is-danger"},[e._v(" "+e._s(e.error)+" ")]):e._e()],1)])},Ve=[];r("25f0");function Je(e){return He.apply(this,arguments)}function He(){return He=Object(i["a"])(regeneratorRuntime.mark((function e(t){var r,a,n,s,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r="https://www.ebi.ac.uk/ols/api/suggest?q=".concat(t),e.next=3,fetch(r);case 3:if(a=e.sent,!a.ok){e.next=23;break}return e.next=7,a.json();case 7:return n=e.sent,s=[],n.response.numFound>0&&(s=n.response.docs.map((function(e){return e.autosuggest}))),o="https://www.ebi.ac.uk/ols/api/select?q=".concat(t),e.next=13,fetch(o);case 13:if(a=e.sent,!a.ok){e.next=19;break}return e.next=17,a.json();case 17:i=e.sent,i.response.numFound>0&&(s=s.concat(i.response.docs.map((function(e){return e.label}))));case 19:return s=s.filter((function(e,t){return s.indexOf(e)==t})),e.abrupt("return",s);case 23:console.error("Failed to fetch compeltion from ebi ols: ".concat(r),a);case 24:case"end":return e.stop()}}),e)}))),He.apply(this,arguments)}var Ge={name:"tags",props:{error:{type:String,default:null},item:{type:Object,required:!0}},data:function(){return{value:void 0,filteredTags:[]}},mounted:function(){this.filteredTags=this.item.options},created:function(){this.value=this.item.value,this.item.value&&this.$emit("input",this.item.value)},methods:{getFilteredTags:function(e){var t=this;Object(_["d"])(Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Je(e);case 2:t.filteredTags=r.sent,t.$forceUpdate();case 4:case"end":return r.stop()}}),r)}))),500)(),this.filteredTags=this.item.options&&this.item.options.filter((function(t){return t.toString().toLowerCase().indexOf(e.toLowerCase())>=0}))}}},Qe=Ge,et=(r("106f"),Object(K["a"])(Qe,Xe,Ve,!1,null,null,null)),tt=et.exports,rt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("label",{staticClass:"label",attrs:{for:e.item.label}},[e._v(" "+e._s(e.item.label)+" "),!1!==e.item.isRequired?r("sup",{staticClass:"has-text-grey-light is-size-7"},[e._v("*")]):e._e()]),r("div",{staticClass:"control"},[r("section",[r("b-field",[r("b-upload",{attrs:{id:e.item.label,multiple:"","drag-drop":"",expanded:""},on:{input:function(t){return e.updateFiles()}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[r("section",{staticClass:"section"},[r("div",{staticClass:"content has-text-centered"},[r("b-icon",{attrs:{icon:"upload",size:"is-large"}}),e._v(" Drop additional files here "),r("br"),e._l(e.value,(function(t,a){return r("span",{key:a,staticClass:"tag is-primary"},[e._v(" "+e._s(t.name.slice(0,20)+(t.name.length>20?"...":""))+" "),r("button",{staticClass:"delete is-small",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.removeFile(e.item.label,a)}}})])})),r("br"),e.value&&e.value.length>0?r("b-button",{staticClass:"is-small",on:{click:function(t){return t.preventDefault(),e.clearFiles()}}},[e._v("Clear files")]):e._e()],2)])])],1)],1),e.error?r("p",{staticClass:"help is-danger"},[e._v(" "+e._s(e.error)+" ")]):e._e()])])},at=[],nt={name:"files",props:{error:{type:String,default:null},item:{type:Object,required:!0}},data:function(){return{value:void 0}},created:function(){this.value=this.item.value,this.item.value&&this.$emit("input",this.item.value)},methods:{removeFile:function(e,t){this.value.splice(t,1),this.$forceUpdate()},clearFiles:function(){this.value=null,this.$emit("input",null),this.$forceUpdate()},updateFiles:function(){this.$emit("input",this.value),this.$forceUpdate()},trimEllip:function(e,t){return e?("object"===Object(Te["a"])(e)&&(e=e.toString()),e.length>t?e.substring(0,t)+"...":e):e}}},st=nt,ot=Object(K["a"])(st,rt,at,!1,null,null,null),it=ot.exports,ct=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dataset"},[e.jsonFields&&e.jsonFields.length>0?r("form-json",{attrs:{btnReset:{value:"Reset"},btnSubmit:{value:"OK"},camelizePayloadKeys:!1,formFields:e.jsonFields,formName:"metadata",components:e.components},on:{formSubmitted:e.formSubmitted}}):e._e()],1)},lt=[],ut=(r("fb5f"),r("0df0")),_t=r.n(ut),dt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[e.item.showLabel?r("label",{staticClass:"label",attrs:{for:e.item.label}},[e._v(" "+e._s(e.item.label)+" "),r("span",{staticClass:"helpLabel has-text-grey-light is-size-7 is-italic",staticStyle:{"margin-left":".5rem","font-weight":"400"}},[e._v(e._s(e.item.help))]),!1!==e.item.isRequired?r("sup",{staticClass:"has-text-grey-light is-size-7"},[e._v("*")]):e._e()]):e._e(),r("div",{staticClass:"control"},[r("section",[r("b-button",{staticClass:"is-primary",attrs:{size:"is-small","icon-left":"plus"},on:{click:e.addNewSample}},[e._v(" New Sample ")]),e.samples&&e.samples.length>0?r("b-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"is-small","icon-left":"plus"},on:{click:function(t){return e.addNewChannel()}}},[e._v(" Add Channel or Modality ")]):e._e(),r("b-tabs",{attrs:{multiline:""},on:{input:function(t){e.currentSample=e.samples[e.activeSample]}},model:{value:e.activeSample,callback:function(t){e.activeSample=t},expression:"activeSample"}},[e._l(e.samples,(function(t,a){return[r("b-tab-item",{key:a,attrs:{value:a,label:t.name},scopedSlots:e._u([{key:"header",fn:function(){return[e.currentSample===t?r("b-input",{staticClass:"input-title",attrs:{placeholder:"Sample Name"},model:{value:t.name,callback:function(r){e.$set(t,"name",r)},expression:"sample.name"}}):r("a",{on:{click:function(r){e.currentSample=t}}},[e._v(" "+e._s(t.name)+" ")]),e.currentSample===t?r("button",{staticClass:"delete is-small",attrs:{type:"button"},on:{click:function(r){return r.stopPropagation(),e.removeSample(t,a)}}}):e._e()]},proxy:!0}],null,!0)},[r("b-table",{attrs:{data:t.channels,"checkbox-position":"left"},scopedSlots:e._u([{key:"default",fn:function(a){return[r("b-table-column",{attrs:{field:"name",label:"Channel/Modality"}},[r("span",[e._v(e._s(a.row.name))])]),r("b-table-column",{attrs:{field:"files",label:"Files"}},[!a.row.files||a.row.files.length<=0?r("span",{staticStyle:{color:"#f39f07"}},[e._v("Not selected")]):r("span",[e._v(e._s(a.row.files.length)+" files ("+e._s(e.totalSize(a.row.files))+")")])]),r("b-table-column",{attrs:{field:"actions",label:"Actions"}},[r("b-upload",{staticClass:"file-label",staticStyle:{display:"inline-block"},attrs:{multiple:"","drag-drop":""},on:{input:function(r){return e.fileSelected(t,a.row,r)}},model:{value:a.row.files,callback:function(t){e.$set(a.row,"files",t)},expression:"props.row.files"}},[r("span",{staticClass:"file-cta"},[r("b-icon",{staticClass:"file-icon",attrs:{icon:"upload"}}),!a.row.files||a.row.files.length<=0?r("span",{staticClass:"file-label"},[e._v("Select or Drag&Drop File(s)")]):r("span",{staticClass:"file-label"},[e._v("Add More File(s)")])],1)]),a.row.files&&a.row.files.length>0?r("span",{staticClass:"file-cta",staticStyle:{display:"inline-block",width:"50px","margin-top":"5px",cursor:"pointer"},on:{click:function(e){e.stopPropagation(),a.row.files=[]}}},[r("b-icon",{staticClass:"file-icon",staticStyle:{"margin-top":"4px"},attrs:{icon:"close"}})],1):e._e()],1)]}},{key:"empty",fn:function(){return[r("div",{staticClass:"has-text-centered"},[e._v("No file selected")])]},proxy:!0}],null,!0)}),t.files&&t.files.length>0?r("p",[e._v(" Screenshots ")]):e._e(),t.files&&t.files.length>0?r("div",{staticClass:"snapshot-container"},[e._l(t.views||[],(function(a,n){return r("div",{key:n,staticClass:"item"},[r("b-button",{staticClass:"close-button",attrs:{size:"is-small","icon-left":"close"},on:{click:function(r){return e.removeScreenshot(t.views,n)}}}),r("img",{staticClass:"image",attrs:{src:a.image,alt:"Screenshot"}})],1)})),r("a",{staticStyle:{"text-align":"center"},on:{click:function(r){return e.previewSample(t)}}},[r("img",{staticClass:"image",staticStyle:{width:"100px","margin-left":"50px","margin-right":"50px"},attrs:{src:"static/img/preview-screenshot.png",alt:"Add button"}}),e._v(" Preview & Screenshot ")])],2):e._e()],1)]}))],2),r("b-field",[r("b-switch",{attrs:{value:e.enableConversion}},[e._v(" Convert to SMLM format (Recommended) ")])],1)],1),e.isDatasetValid?r("p",{staticClass:"help is-danger"},[e._v(" You should add at least one sample and take some screenshots for the cover. ")]):e._e(),e.error?r("p",{staticClass:"help is-danger"},[e._v(" "+e._s(e.error)+" ")]):e._e()])])},pt=[];r("13d5"),r("b680");function ft(e){var t,r=[],a=Object(l["a"])(e.channels);try{for(a.s();!(t=a.n()).done;)for(var n=t.value,s=0;s<n.files.length;s++){var o=n.files[s],i=void 0;i=o instanceof Blob?new File([o],(n.files.length>1?n.name+"-"+s:n.name)+"."+o.name.split(".").pop(),{type:o.type,lastModified:o.lastModified}):Object.assign({},o),i.originalName=o.name,i.sampleName=e.name,r.push(i)}}catch(fr){a.e(fr)}finally{a.f()}return r}var ht={name:"file-preview",props:{error:{type:String,default:null},item:{type:Object,required:!0}},data:function(){return{viewer:null,activeSample:0,samples:[],fileCache:{},currentFile:null,enableConversion:!0,currentSample:null,sampleChannels:[],sampleRunningNumber:0}},created:function(){this.samples=this.item.value||[];var e,t=Object(l["a"])(this.samples);try{for(t.s();!(e=t.n()).done;){var r=e.value;if(r.files){var a=r.files;r.channels=[];var n,s=Object(l["a"])(a);try{var o=function(){var e=n.value,t=e.name.split("-")[0].split(".")[0];if(r.channels.map((function(e){return e.name})).includes(t)){var a=r.channels.find((function(e){return e.name===t}));a.files.push(e)}else r.channels.push({name:t,files:[e]})};for(s.s();!(n=s.n()).done;)o()}catch(fr){s.e(fr)}finally{s.f()}}}}catch(fr){t.e(fr)}finally{t.f()}this.commitValue()},computed:Object(a["a"])({isDatasetValid:function(){if(this.samples.length<=0)return!1;var e,t=[],r=Object(l["a"])(this.samples);try{for(r.s();!(e=r.n()).done;){var a=e.value;a.views&&(t=t.concat(a.views))}}catch(fr){r.e(fr)}finally{r.f()}return t.length>0}},Object(c["b"])({imjoyReady:function(e){return e.imjoyReady},imjoy:function(e){return e.imjoy}})),watch:{activeSample:function(e){this.currentSample=this.samples[e],this.$forceUpdate()}},methods:{fileSelected:function(e,t,r){if(!r[0]||!r[0].name)return alert("Invalid file(s)! If you are uploading network shared files, please copy them to a local folder."),void(t.files=[]);e.name.match(/$sample-[0-9]+/)&&(e.name=r[0].name.split(/[-, .|:_]+/)[0],e.name.length<3&&(e.name=e.name+"-"+this.samples.length)),this.commitValue()},totalSize:function(e){var t=e.reduce((function(e,t){return e+t.size}),0)/1024/1024;return isNaN(t)?"unkown":(t>1?Math.round(t):t.toFixed(1))+"MB"},addNewChannel:function(e){if(!e){if(e=prompt("Please give a unique name for the new channel or modality in lower case, e.g. smlm, raw, widefield, actin, alpha_tubulin.","default"),e&&e.includes("-"))return void alert('"Hyphen(-) is not allowed in the name, please remove it or use underscore instead.');if(e&&this.sampleChannels.includes(e.toLowerCase()))return void alert('"'.concat(e.toLowerCase(),'" already exists, please choose another name.'))}if(!e)throw new Error("Empty channel name");if(e=e.toLowerCase(),this.sampleChannels.includes(e))alert('"'.concat(e,'" already exists, please choose another name.'));else{this.sampleChannels.push(e);var t,r=Object(l["a"])(this.samples);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.channels=a.channels||[],a.channels.find((function(t){return t.name===e}))||a.channels.push({name:e,files:[]})}}catch(fr){r.e(fr)}finally{r.f()}}},addNewSample:function(){(!this.sampleChannels||this.sampleChannels.length<=0)&&this.addNewChannel(),this.sampleRunningNumber+=1,this.samples.push({name:"sample-"+this.sampleRunningNumber,channels:this.sampleChannels.map((function(e){return{name:e,files:[]}}))}),this.activeSample=this.samples.length-1,this.currentSample=this.samples[this.samples.length-1],this.commitValue()},commitValue:function(){var e,t=Object(l["a"])(this.samples);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.files=ft(r)}}catch(fr){t.e(fr)}finally{t.f()}var a=this.samples.filter((function(e){return e.files&&e.files.length>0}));a.enableConversion=this.enableConversion,this.$emit("input",a),this.$forceUpdate()},removeScreenshot:function(e,t){e.splice(t,1),this.commitValue(),this.$forceUpdate()},capture:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.viewer.captureImage();case 2:return r=t.sent,t.next=5,e.viewer.getViewConfig();case 5:a=t.sent,a["files"]=e.currentFiles&&e.currentFiles.map((function(e){return e.name})),a["viewer_type"]=e.viewer.config.type,e.currentSample.views=e.currentSample.views||[],e.currentSample.views.filter((function(e){return e.image===r})).length<=0?e.currentSample.views.push({config:a,image:r}):e.imjoy.api.showMessage("Please change the image to another view and try again."),e.commitValue(),e.imjoy.api.showMessage("New screenshot added!"),e.$forceUpdate();case 13:case"end":return t.stop()}}),t)})))()},removeSample:function(e,t){this.samples.splice(t,1),this.activeSample=t-1,this.commitValue(),this.$forceUpdate()},removeFile:function(e,t){var r=e[t];this.currentFiles&&this.currentFiles.includes(r)&&(this.currentFiles=null),e.splice(t,1),this.commitValue(),this.$forceUpdate()},trimEllip:function(e,t){return e?("object"===Object(Te["a"])(e)&&(e=e.toString()),e.length>t?e.substring(0,t)+"...":e):e},displayImage:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=r.$buefy.loading.open({container:r.$el,canCancel:!0}),a.prev=1,a.next=4,r.imjoy.api.showDialog({name:e.name.slice(0,40),src:"https://kaibu.org/#/app",w:10,h:5,config:{open_sidebar:!1},window_id:t});case 4:return r.viewer=a.sent,a.next=7,new Promise((function(t,r){var a=new FileReader;a.onloadend=function(){t(a.result)},a.onerror=r,a.readAsDataURL(e)}));case 7:return s=a.sent,a.next=10,r.viewer.view_image(s);case 10:return a.abrupt("return");case 13:throw a.prev=13,a.t0=a["catch"](1),console.error(a.t0),a.t0;case 17:return a.prev=17,n.close(),a.finish(17);case 20:case"end":return a.stop()}}),a,null,[[1,13,17,20]])})))()},fetchRemoteFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,t.fileCache[e.url]){r.next=10;break}return r.next=4,Object(_["f"])(e.url,e.name,t.imjoy&&t.imjoy.api.showMessage);case 4:a=r.sent,a.remote=e,t.fileCache[e.url]=a,e=a,r.next=11;break;case 10:e=t.fileCache[e.url];case 11:r.next=17;break;case 13:r.prev=13,r.t0=r["catch"](0),console.error(r.t0),alert("Failed to fetch file from ".concat(e.url,": ").concat(r.t0));case 17:return r.abrupt("return",e);case 18:case"end":return r.stop()}}),r,null,[[0,13]])})))()},markFileConversion:function(e,t){var r=this,a="data";a.endsWith(".smlm")||(a+=".smlm"),e.convert=Object(i["a"])(regeneratorRuntime.mark((function n(){var s,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,r.imjoy.api.getPlugin("SMLM File IO");case 2:return s=n.sent,n.next=5,s.load(t);case 5:return o=n.sent,n.next=8,o.save(a);case 8:return i=n.sent,i.sampleName=e.name,i.converted=t,n.abrupt("return",i);case 12:case"end":return n.stop()}}),n)}))),e.converted=t,e.convertFileName=a},previewSample:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i,c,u,d,p,f,h,m,g,b,v,y,w,k,x;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.currentSample=e,a=ft(e),a.forEach((function(t){return t.sampleName=e.name})),n=t.imjoy.api,s=t.$buefy.loading.open({canCancel:!0,container:t.$el}),o=Object(_["h"])(),i=[],c=Object(l["a"])(a),r.prev=8,c.s();case 10:if((u=c.n()).done){r.next=31;break}if(d=u.value,"remote"!==d.type){r.next=20;break}return r.t0=i,r.next=16,t.fetchRemoteFile(d);case 16:r.t1=r.sent,r.t0.push.call(r.t0,r.t1),r.next=29;break;case 20:if("generator"!==d.type){r.next=28;break}return r.t2=i,r.next=24,d.generate();case 24:r.t3=r.sent,r.t2.push.call(r.t2,r.t3),r.next=29;break;case 28:i.push(d);case 29:r.next=10;break;case 31:r.next=36;break;case 33:r.prev=33,r.t4=r["catch"](8),c.e(r.t4);case 36:return r.prev=36,c.f(),r.finish(36);case 39:if(t.currentFiles=i,r.prev=40,p=[],f=i.filter((function(e){return e.name.endsWith(".smlm")||e.name.endsWith(".csv")||e.name.endsWith(".tsv")||e.name.endsWith(".xls")||e.name.endsWith(".txt")})),!(f.length<=0)){r.next=60;break}if(h=i[0].name.toLowerCase(),!(h.endsWith(".png")||h.endsWith(".jpeg")||h.endsWith(".jpg"))){r.next=58;break}return r.prev=46,r.next=49,t.displayImage(i[0],o);case 49:r.next=54;break;case 51:r.prev=51,r.t5=r["catch"](46),alert("".concat(r.t5));case 54:return s.close(),r.abrupt("return");case 58:alert("No localization file found (only support .smlm, .csv, .tsv, .xls and .txt files)");case 59:return r.abrupt("return");case 60:return r.next=62,n.getPlugin("SMLM File IO");case 62:m=r.sent,g=Object(l["a"])(f),r.prev=64,g.s();case 66:if((b=g.n()).done){r.next=84;break}return v=b.value,r.prev=68,r.next=71,m.load(v);case 71:y=r.sent,p=p.concat(y.files),r.next=79;break;case 75:r.prev=75,r.t6=r["catch"](68),console.error(r.t6),alert("".concat(r.t6));case 79:return r.prev=79,s.close(),r.finish(79);case 82:r.next=66;break;case 84:r.next=89;break;case 86:r.prev=86,r.t7=r["catch"](64),g.e(r.t7);case 89:return r.prev=89,g.f(),r.finish(89);case 92:return t.markFileConversion(e,f),w=window.location.origin+window.location.pathname,r.next=96,n.showDialog({name:e.name.slice(0,40),src:w+"FairyDust.imjoy.html",data:p,window_id:o});case 96:return t.viewer=r.sent,p=null,t.viewer.captureImage&&(k=document.getElementById(o),x=document.createElement("button"),x.innerHTML="Take a screenshot",x.classList.add("button"),x.classList.add("snap-button"),x.onclick=function(){t.capture()},k.appendChild(x)),r.next=101,n.showMessage("Done! Please use the 'Take a screenshot' button to create more cover images.");case 101:(!t.currentSample.views||t.currentSample.views.length<=0)&&setTimeout((function(){t.capture()}),1e3),r.next=108;break;case 104:r.prev=104,r.t8=r["catch"](40),console.error(r.t8),alert("".concat(r.t8));case 108:return r.prev=108,s.close(),r.finish(108);case 111:case"end":return r.stop()}}),r,null,[[8,33,36,39],[40,104,108,111],[46,51],[64,86,89,92],[68,75,79,82]])})))()}}},mt=ht,gt=(r("12a0"),Object(K["a"])(mt,dt,pt,!1,null,"c2aba96e",null)),bt=gt.exports,vt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("label",{staticClass:"label",attrs:{for:e.item.label}},[e._v(" "+e._s(e.item.label)+" "),r("span",{staticClass:"helpLabel has-text-grey-light is-size-7 is-italic",staticStyle:{"margin-left":".5rem","font-weight":"400"}},[e._v(e._s(e.item.help))]),!1!==e.item.isRequired?r("sup",{staticClass:"has-text-grey-light is-size-7"},[e._v("*")]):e._e()]),r("div",{staticClass:"control"},[e._l(e.value,(function(t,a){return r("div",{key:a},[r("b-field",[r("b-input",{attrs:{type:"text",placeholder:"Citation text",maxlength:"1000"},on:{input:e.commitValue},model:{value:t.text,callback:function(r){e.$set(t,"text",r)},expression:"citation.text"}}),r("b-input",{attrs:{type:"text",placeholder:"DOI (optional)",maxlength:"100"},on:{input:e.commitValue},model:{value:t.doi,callback:function(r){e.$set(t,"doi",r)},expression:"citation.doi"}}),r("b-input",{attrs:{type:"text",placeholder:"URL (optional)",maxlength:"1000"},on:{input:e.commitValue},model:{value:t.url,callback:function(r){e.$set(t,"url",r)},expression:"citation.url"}}),e.value.length>1?r("b-button",{staticClass:"button",staticStyle:{"text-transform":"none"},attrs:{"icon-left":"delete"},on:{click:function(r){return e.removeCitation(t)}}}):e._e(),a===e.value.length-1&&t.text&&""!==t.text?r("b-button",{staticClass:"button",staticStyle:{"text-transform":"none"},attrs:{"icon-left":"plus"},on:{click:e.addNewCitation}}):e._e()],1)],1)})),e.error?r("p",{staticClass:"help is-danger"},[e._v(" "+e._s(e.error)+" ")]):e._e()],2)])},yt=[],wt={name:"citation",props:{error:{type:String,default:null},item:{type:Object,required:!0}},data:function(){return{value:void 0,filteredTags:[]}},mounted:function(){this.filteredTags=this.item.options},created:function(){this.value=this.item.value,"string"===typeof this.value&&(this.value=[{text:this.value}]),this.value&&!Array.isArray(this.value)&&(this.value=[this.value]),this.value=this.value||[],this.value.length<=0&&this.value.push({text:"",doi:"",url:""}),this.commitValue()},methods:{commitValue:function(){this.value.length<=0?this.$emit("input",null):""===this.value[this.value.length-1].text?this.$emit("input",this.value.slice(0,this.value.length-1)):this.$emit("input",this.value)},addNewCitation:function(){""!==this.value[this.value.length-1].text&&this.value.push({}),this.commitValue()},removeCitation:function(e){var t=this.value.indexOf(e);t>=0&&this.value.splice(t,1),this.commitValue()}}},kt=wt,xt=(r("fff7"),Object(K["a"])(kt,vt,yt,!1,null,null,null)),Ot=xt.exports,Et=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("label",{staticClass:"label",attrs:{for:e.item.label}},[e._v(" "+e._s(e.item.label)+" "),r("span",{staticClass:"helpLabel has-text-grey-light is-size-7 is-italic",staticStyle:{"margin-left":".5rem","font-weight":"400"}},[e._v(e._s(e.item.help))]),!1!==e.item.isRequired?r("sup",{staticClass:"has-text-grey-light is-size-7"},[e._v("*")]):e._e()]),r("div",{staticClass:"control"},[e._l(e.value,(function(t,a){return r("div",{key:a},[r("b-field",[r("b-input",{attrs:{type:"text",placeholder:"Full Name",maxlength:"1000"},on:{input:e.commitValue},model:{value:t.name,callback:function(r){e.$set(t,"name",r)},expression:"author.name"}}),r("b-input",{attrs:{type:"text",placeholder:"Affiliation (optional)",maxlength:"100"},on:{input:e.commitValue},model:{value:t.affiliation,callback:function(r){e.$set(t,"affiliation",r)},expression:"author.affiliation"}}),r("b-input",{attrs:{type:"text",placeholder:"ORCID (optional)",maxlength:"1000"},on:{input:e.commitValue},model:{value:t.orcid,callback:function(r){e.$set(t,"orcid",r)},expression:"author.orcid"}}),e.value.length>1?r("b-button",{staticClass:"button",staticStyle:{"text-transform":"none"},attrs:{"icon-left":"delete"},on:{click:function(r){return e.removeAuthor(t)}}}):e._e(),a===e.value.length-1&&t.name&&""!==t.name?r("b-button",{staticClass:"button",staticStyle:{"text-transform":"none"},attrs:{"icon-left":"plus"},on:{click:e.addNewAuthor}}):e._e()],1)],1)})),e.error?r("p",{staticClass:"help is-danger"},[e._v(" "+e._s(e.error)+" ")]):e._e()],2)])},Ct=[],It={name:"author",props:{error:{type:String,default:null},item:{type:Object,required:!0}},data:function(){return{value:void 0,filteredTags:[]}},mounted:function(){this.filteredTags=this.item.options},created:function(){this.value=this.item.value,this.value&&!Array.isArray(this.value)&&(this.value=[this.value]),this.value=this.value||[],this.value=this.value.filter((function(e){return e.name&&""!=e.name})),this.commitValue(),this.value.length<=0&&this.value.push({})},methods:{commitValue:function(){this.value.length<=0?this.$emit("input",null):""===this.value[this.value.length-1].name?this.$emit("input",this.value.slice(0,this.value.length-1)):this.$emit("input",this.value)},addNewAuthor:function(){""!==this.value[this.value.length-1].name&&this.value.push({}),this.commitValue()},removeAuthor:function(e){var t=this.value.indexOf(e);t>=0&&this.value.splice(t,1),this.commitValue()}}},Dt=It,Mt=(r("e067"),Object(K["a"])(Dt,Et,Ct,!1,null,null,null)),Pt=Mt.exports,Rt={name:"upload-form",props:["resourceId","initRdf"],components:{"form-json":_t.a,TagInputField:tt,DropFilesField:it,FilePreviewField:bt,CitationInputField:Ot,AuthorInputField:Pt},computed:Object(a["a"])({components:function(){return{TagInputField:tt,DropFilesField:it,FilePreviewField:bt,CitationInputField:Ot,AuthorInputField:Pt}}},Object(c["b"])({client:function(e){return e.zenodoClient},resourceItems:function(e){return e.resourceItems},allTags:function(e){return e.allTags}})),data:function(){return{jsonFields:[],expandOnHover:!1,expandWithDelay:!1,reduce:!1,rdf:null}},mounted:function(){this.initializeRdfForm(this.initRdf),this.$root.$on("formSubmitted",this.formSubmitted)},methods:{transformFields:function(e){var t={};for(var r in this.components)t[this.components[r].name]=r;var a,n=Object(l["a"])(e);try{for(n.s();!(a=n.n()).done;){var s=a.value;t[s.type]&&(s.is=t[s.type],delete s.type)}}catch(fr){n.e(fr)}finally{n.f()}return e},formSubmitted:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i,c,u,d,p,f,h,m,g;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:for(o in a=[],n={name:"Dataset Name",description:"Description",license:"License",authors:"Authors",uploaded_by:"Uploaded by",contact_email:"Contact Email",tags:"Tags",cite:"Citation",links:"Links"},s=e.values,t.rdf={},n)t.rdf[o]=s[n[o]];try{localStorage.setItem("license",t.rdf.license),localStorage.setItem("uploaded_by",t.rdf.uploaded_by),localStorage.setItem("contact_email",t.rdf.contact_email)}catch(b){console.error(b)}if(i="rdf.yaml",t.rdf.type="dataset",t.rdf.links=t.rdf.links||[],t.rdf.tags=t.rdf.tags||[],t.rdf.config=t.rdf.config||{},t.rdf.config._rdf_file="./"+i,t.rdf.config._docstring=s["Documentation"],c=s["Samples"],t.rdf.tags.includes("smlm")||t.rdf.tags.push("smlm"),t.rdf.config._docstring&&(u=new Blob([t.rdf.config._docstring],{type:"text/markdown"}),d=new File([u],"README.md"),t.rdf.documentation="./README.md",a.push(d),delete t.rdf.config._docstring),!(c&&c.length>0)){r.next=36;break}t.rdf.covers=t.rdf.covers||[],t.rdf.config=t.rdf.config||{},p=10,f=Object(l["a"])(c),r.prev=21,m=regeneratorRuntime.mark((function e(){var r,n,s,o,i,u,d,f,m,g,b,v,y,w,k,x,O,E,C,I,D,M;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=h.value,c.enableConversion&&o.convert&&(i=o.converted&&o.converted.map((function(e){return e.name}))||[],o.files=o.files.filter((function(e){return!i.includes(e.name)&&e.name!==o.convertFileName})),u=o.converted.map((function(e){return e.originalName})),o.files.push({type:"generator",name:o.convertFileName,sampleName:o.name,generate:o.convert,originalName:u})),d=Object(l["a"])(o.files);try{for(d.s();!(f=d.n()).done;)m=f.value,"remote"!==m.type&&a.push(m)}catch(fr){d.e(fr)}finally{d.f()}if(g=0,o.views){e.next=8;break}throw alert("Please take screenshots for "+o.name),new Error("No screenshot found for "+o.name);case 8:b=null===(r=t.rdf.config)||void 0===r||null===(n=r._deposit)||void 0===n||null===(s=n.links)||void 0===s?void 0:s.bucket,v=Object(l["a"])(o.views),e.prev=10,v.s();case 12:if((y=v.n()).done){e.next=49;break}if(w=y.value,k=w.image,x=void 0,!k.startsWith("http")){e.next=30;break}if(O=k.split("?")[0].split("/").pop(),!b||k!=="".concat(b,"/").concat(o.name,"/").concat(O)){e.next=23;break}return t.rdf.covers.push("./".concat(o.name,"/").concat(O)),e.abrupt("continue",47);case 23:return e.next=25,fetch(k);case 25:return e.next=27,e.sent.blob();case 27:x=e.sent;case 28:e.next=31;break;case 30:x=Object(_["c"])(k);case 31:E=a.map((function(e){return e.name}));while(E.includes("screenshot-"+g+".png")||E.includes("screenshot-"+g+"_thumbnail.png"))g++;if(C="screenshot-"+g,I=new File([x],C+".png",{type:x.type}),I.sampleName=o.name,a.push(I),w.image_name=C+".png",!(p>=0)){e.next=47;break}return e.next=41,Object(_["j"])({file:I,maxSize:256});case 41:D=e.sent,M=new File([D],C+"_thumbnail.png",{type:D.type}),M.sampleName=o.name,a.push(M),t.rdf.covers.push("./".concat(o.name,"/").concat(C,"_thumbnail.png")),p--;case 47:e.next=12;break;case 49:e.next=54;break;case 51:e.prev=51,e.t0=e["catch"](10),v.e(e.t0);case 54:return e.prev=54,v.f(),e.finish(54);case 57:case"end":return e.stop()}}),e,null,[[10,51,54,57]])})),f.s();case 24:if((h=f.n()).done){r.next=28;break}return r.delegateYield(m(),"t0",26);case 26:r.next=24;break;case 28:r.next=33;break;case 30:r.prev=30,r.t1=r["catch"](21),f.e(r.t1);case 33:return r.prev=33,f.f(),r.finish(33);case 36:t.rdf.attachments=t.rdf.attachments||{},t.rdf.attachments.samples=c.map((function(e){return{name:e.name,views:e.views,files:e.files.map((function(e){return{name:e.name,size:e.size||null,originalName:e.originalName||null}}))}})),g=Object.assign({},t.rdf),delete g._metadata,console.log("RDF: ",g),t.rdf.config._files=a,t.$emit("submit",t.rdf);case 43:case"end":return r.stop()}}),r,null,[[21,30,33,36]])})))()},initializeRdfForm:function(e){var t=this;this.rdf=e||{},this.rdf.type="dataset",this.rdf.format_version=this.rdf.format_version||"0.2.0",this.rdf.config=this.rdf.config||{},this.rdf.attachments=this.rdf.attachments||{};try{this.rdf.license=this.rdf.license||localStorage.getItem("license"),this.rdf.uploaded_by=this.rdf.uploaded_by||localStorage.getItem("uploaded_by"),this.rdf.contact_email=this.rdf.contact_email||localStorage.getItem("contact_email")}catch(r){}Object.keys(f.a).includes(this.rdf.license)||(this.rdf.license=null),this.rdf.license=this.rdf.license||"CC-BY-4.0",this.jsonFields=this.transformFields([{label:"Dataset Name",placeholder:"dataset name",value:this.rdf.name,help:"A human-readable descriptive name for your dataset to be uploaded. You can capitalize and use spaces (instead of underscores) to separate words, for example: `Xenopus NPC exmperiment-1`."},{html:'<p class=\'label\'>Samples<span\n        class="helpLabel has-text-grey-light is-size-7 is-italic"\n        style="margin-left: .5rem;font-weight: 400;"\n        >Add samples to the dataset. A dataset contains multiple samples, each sample may contain one or more files for the same field of view, with single or multiple channels/modalities. Click "NEW SAMPLE" to add a new sample. If you want to add more channels, widefield, or raw tif stack for each sample, click "ADD CHANNEL OR MODALITY". The total file size for one dataset should be less than 50GB, otherwise please split into several datasets. Each sample should contain at lease one supported localization file (.smlm, .csv, .tsv, .xls and .txt), and you can test whether they are supported with the preview button. If you have other localization file format which is not supported yet, please <a href="https://www.dropbox.com/request/IyZ7HkzHUpB0t5Mkp46l" target="_blank">upload a sample file</a>, and <a href="https://oeway.typeform.com/to/rdkPmd" target="_blank">send us a message</a> to describe your file format, we will try to support your file format.</span><sup class=\'has-text-grey-light is-size-7\'> *</sup></p>'},{label:"Samples",type:"file-preview",showLabel:!1,value:this.rdf.attachments.samples,isRequired:!0},{label:"Description",placeholder:"description of the dataset",value:this.rdf.description,help:"A short description in one sentence. Example: `Nuclear pore protein gp120 in extracted nuclear envelope of Xenopus eggs.`"},{label:"Authors",type:"author",value:this.rdf.authors,help:"The authors who contributed to this dataset"},{label:"Uploaded by",value:this.rdf.uploaded_by,placeholder:"Full Name",help:"The name of person who is uploading this dataset"},{label:"Contact Email",type:"email",value:this.rdf.contact_email,help:"A contact email for anwsering enquiry of the dataset, or potential change request from the admin from ShareLoc team."},{html:'<p class=\'label\'>License<span\n        class="helpLabel has-text-grey-light is-size-7 is-italic"\n        style="margin-left: .5rem;font-weight: 400;"\n        >Choose the license that fits you most, we recommend to use <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">CC-BY-4.0</a> (free to share and adapt under the condition of attribution). For other license options, please visit here <a target="_blank" href="https://spdx.org/licenses">https://spdx.org/licenses<a></span><sup class=\'has-text-grey-light is-size-7\'> *</sup></p>'},{label:"License",showLabel:!1,type:"select",placeholder:"Select your license",options:Object.keys(f.a).map((function(e){return{text:e,value:e,selected:t.rdf.license===e}}))},{label:"Tags",type:"tags",value:this.rdf.tags,placeholder:"Add a tag and press ENTER to confirm",options:this.allTags,allow_new:!0,icon:"label",help:"Please use multiple tags to describe imaging modality, cell line, imaged structure(s), fluorophore, labeling strategy, target protein, dimension, camera, buffer, fixation etc. Here are some examples: `dstorm`, `u373`, `microtubules`, `alexa-647`, `secondary-antibody`, `alpha-tubulin`,`2d`,`em-ccd`,`pfa+gluta`, `thunderstorm`. Tag suggestions are obtained from the EBI ontology service (https://www.ebi.ac.uk/ols/), please try to reuse existing ontology terms, and only add new tags if necessary.",isRequired:!0},{label:"Documentation",placeholder:"",type:"textarea",value:this.rdf.config._docstring,help:"Full documentation in markdown format, covering how the dataset is obtained and link to publications etc.",isRequired:!1},{label:"Citation",type:"citation",value:this.rdf.cite,placeholder:"Add a citation",help:"Indicate how this dataset should be cited",isRequired:!1},{label:"Links",type:"tags",value:this.rdf.links,placeholder:"Add a link (resource item ID)",options:this.resourceItems.map((function(e){return e.id})),allow_new:!0,help:"Optinally, you can link to other uploaded datasets or applications",icon:"vector-link",isRequired:!1}])}}},jt=Rt,Lt=(r("51a2"),Object(K["a"])(jt,ct,lt,!1,null,null,null)),Tt=Lt.exports,St=r("67be"),Ut=r.n(St),At=r("63c3"),Wt={name:"upload",props:["updateDepositId"],components:{markdown:Be["a"],TagInputField:tt,DropFilesField:it,UploadForm:Tt},mounted:function(){var e=this;if(this.dropFiles=null,this.uploadStatus="",this.uploadProgress=0,!this.loadedUrl){var t=this.siteConfig.rdf_root_repo,r=this.siteConfig.manifest_url;this.$store.dispatch("fetchResourceItems",{repo:t,manifest_url:r})}"bookmarks"===this.updateDepositId?this.imjoyReady.then((function(t){e.startFromBookmarks(t).catch((function(e){alert("Failed to load from deposit URL: ".concat(e))}))})):this.updateDepositId&&this.startFromDepositURL().catch((function(e){alert("Failed to load from deposit URL: ".concat(e))}))},computed:Object(a["a"])({sameNameDeposits:function(){var e=this;return this.similarDeposits&&this.similarDeposits.filter((function(t){return t.name===e.rdf.name}))},formatedModelYaml:function(){return this.rdfYaml&&"```yaml\n"+this.rdfYaml+"\n```\n"},prereserveUrl:function(){return this.prereserveDOI?"".concat(this.$store.state.zenodoBaseURL,"/deposit/").concat(this.prereserveDOI.recid):null},userId:function(){return this.client&&this.client.getUserId()}},Object(c["b"])({imjoyReady:function(e){return e.imjoyReady},imjoy:function(e){return e.imjoy},siteConfig:function(e){return e.siteConfig},loadedUrl:function(e){return e.loadedUrl},resourceItems:function(e){return e.resourceItems},client:function(e){return e.zenodoClient},zenodoBaseURL:function(e){return e.zenodoBaseURL},bookmarks:function(e){return e.bookmarks}})),data:function(){return{server:null,artifactManager:null,dropFiles:null,uploadProgress:0,uploadStatus:"",uploaded:!1,jsonFields:null,rdfYaml:null,rdf:null,stepIndex:0,publishedUrl:null,publishedDOI:null,requestedJoinCommunity:!0,rdfType:"model",editedFiles:null,prereserveDOI:null,URI4Load:null,similarDeposits:null,depositId:null,uploadMode:null}},methods:{switchToSandbox:function(){var e=Object.assign({},this.$route.query);e.sandbox=1,delete e.production,this.$router.replace({query:e}),this.$router.go(this.$router.currentRoute)},switchToProduction:function(){var e=Object.assign({},this.$route.query);e.production=1,delete e.sandbox,this.$router.replace({query:e}),this.$router.go(this.$router.currentRoute)},gettingStarted:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.imjoy.api.showDialog({src:"https://slides.imjoy.io/?slides=https://raw.githubusercontent.com/imodpasteur/ShareLoc.XYZ/main/docs/how-to-upload-slides.md",passive:!0,name:"Getting Started",fullscreen:!0});case 2:case"end":return t.stop()}}),t)})))()},startFromBookmarks:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.generateYamlFile(t.bookmarks[0]);case 2:t.rdf=r.sent.rdf,a=[],n=Object(l["a"])(t.bookmarks);try{for(o=function(){var r,n=s.value;if(null!==n&&void 0!==n&&null!==(r=n.attachments)&&void 0!==r&&r.samples&&(a=a.concat(n.attachments.samples)),n.tags.forEach((function(e){t.rdf.tags.includes(e)||t.rdf.tags.push(e)})),n.download_url){var o=n.download_url.split("?")[0].split("/").pop();a.push({name:n.name,files:[{type:"generator",generate:function(){return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(_["f"])(n.download_url,o,(function(t){e.api.showMessage(t)}));case 2:return r=t.sent,r.originalName=r.name,r.converted=[r],r.sampleName=n.name,t.abrupt("return",r);case 7:case"end":return t.stop()}}),t)})))()},size:n.size,sampleName:n.name,name:o,url:n.download_url}],views:n.covers.map((function(e){return{image:e,image_name:e.split("?")[0].split("/").pop()}}))})}},n.s();!(s=n.n()).done;)o()}catch(fr){n.e(fr)}finally{n.f()}t.rdf.attachments=t.rdf.attachments||{},t.rdf.attachments.samples=a,t.stepIndex=1;case 9:case"end":return r.stop()}}),r)})))()},startFromDepositURL:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.$buefy.loading.open({container:e.$el}),t.prev=1,e.server){t.next=5;break}return t.next=5,e.login();case 5:return e.URI4Load="".concat(e.zenodoBaseURL,"/record/").concat(e.updateDepositId),t.next=8,e.loadRdfFromURL(e.URI4Load);case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](1),alert("Failed to load resource: "+e.updateDepositId);case 13:return t.prev=13,r.close(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})))()},startUpload:function(){this.rdf={},this.stepIndex=1},submitRDF:function(e){var t=this;this.$nextTick(Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.generateYamlFile(e);case 2:t.rdfYaml=r.sent.text,t.editedFiles=e.config._files,delete e.config._files,t.rdf=e,t.stepIndex=2,t.$forceUpdate();case 8:case"end":return r.stop()}}),r)}))))},loadRdfFromURL:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i,c,l,u;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(r.prev=0,a=Ut.a.resolvePath(),!a.test(e)){r.next=8;break}return r.next=5,Object(_["k"])(e.match(a)[4]);case 5:e=r.sent,r.next=12;break;case 8:if(!Ut()().test(e)){r.next=12;break}return r.next=11,Object(_["k"])(e);case 11:e=r.sent;case 12:if(n=/zenodo.org\/(record|deposit)\/([0-9]+)/,s=n.exec(e),!s){r.next=45;break}if(t.depositId=parseInt(s[2]),!e.includes("/record/")){r.next=22;break}return r.next=19,t.client.getDeposit(t.depositId);case 19:o=r.sent,r.next=27;break;case 22:return r.next=24,t.client.getCredential(!0);case 24:return r.next=26,t.client.retrieve(t.depositId);case 26:o=r.sent;case 27:return console.log("orcid matched: "+t.depositId,o),i=Object(_["e"])(o),r.next=31,Object(_["g"])(i);case 31:if(t.rdf=r.sent,console.log("Full RDF:",t.rdf),!t.rdf.documentation){r.next=42;break}return c=o.links.bucket+"/",l=t.rdf.documentation.startsWith("http")?t.rdf.documentation:new URL(t.rdf.documentation,c).href,r.next=38,fetch(l);case 38:return u=r.sent,r.next=41,u.text();case 41:t.rdf.config._docstring=r.sent;case 42:t.stepIndex=1,r.next=46;break;case 45:alert("Failed to parse RDF URL: ".concat(e));case 46:r.next=52;break;case 48:r.prev=48,r.t0=r["catch"](0),console.error(r.t0),alert("Failed to fetch RDF from ".concat(e,", error: ").concat(r.t0));case 52:case"end":return r.stop()}}),r,null,[[0,48]])})))()},publishDeposition:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.artifactManager&&e.depositId){t.next=3;break}return alert("Artifact Manager not connected or deposit ID missing."),t.abrupt("return");case 3:return r=e.$buefy.loading.open({container:e.$el}),t.prev=4,t.next=7,e.artifactManager.commit(e.depositId);case 7:console.log("Artifact committed!",e.depositId),e.publishedDOI=e.rdf.id,e.publishedUrl="".concat(e.siteConfig.hypha_server_url,"/shareloc-xyz/artifacts/shareloc-collection/").concat(e.depositId.split("/")[1]),alert("The deposition has been successfully committed and published!"),t.next=17;break;case 13:t.prev=13,t.t0=t["catch"](4),console.error("Failed to commit the artifact:",t.t0),alert("Failed to publish the deposition: ".concat(t.t0.message));case 17:return t.prev=17,r.close(),t.finish(17);case 20:case"end":return t.stop()}}),t,null,[[4,13,17,20]])})))()},logout:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:window.open(e.siteConfig.hypha_server_url+"/login","_blank");case 1:case"end":return t.stop()}}),t)})))()},login:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,At["hyphaWebsocketClient"].login({server_url:e.siteConfig.hypha_server_url,login_callback:function(e){window.open(e.login_url,"_blank")}});case 3:return r=t.sent,t.next=6,At["hyphaWebsocketClient"].connectToServer({server_url:e.siteConfig.hypha_server_url,token:r});case 6:return e.server=t.sent,t.next=9,e.server.getService("public/artifact-manager");case 9:e.artifactManager=t.sent,e.$forceUpdate(),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),alert("Failed to login: ".concat(t.t0));case 16:case"end":return t.stop()}}),t,null,[[0,13]])})))()},generateYamlFile:function(e){return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=Object.assign({},e),delete n.config,s=Ze.a.dump(n),s=Ze.a.load(s),null!==(r=s)&&void 0!==r&&null!==(a=r.attachments)&&void 0!==a&&a.samples&&s.attachments.samples.forEach((function(e){e.views.forEach((function(e){delete e.image}))})),s=Ze.a.dump(s),o=new Blob([s],{type:"application/yaml"}),i=new File([o],"rdf.yaml",{type:"application/yaml"}),i.text=s,i.rdf=n,t.abrupt("return",i);case 11:case"end":return t.stop()}}),t)})))()},createOrUpdateDeposit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i,c,l;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.artifactManager){r.next=3;break}return alert("Artifact Manager not connected."),r.abrupt("return");case 3:return a=t.$buefy.loading.open({container:t.$el}),t.similarDeposits=null,t.uploadProgress=1,r.prev=6,r.next=9,t.artifactManager.create({parent_id:"shareloc-xyz/shareloc-collection",workspace:"shareloc-xyz",alias:e,manifest:t.rdf,version:"stage",overwrite:!0,_rkwargs:!0});case 9:n=r.sent,t.depositId=n.id,s=0;case 12:if(!(s<t.editedFiles.length)){r.next=32;break}if(o=t.editedFiles[s],"generator"!==o.type){r.next=18;break}return r.next=17,o.generate();case 17:o=r.sent;case 18:return i=o.sampleName?"".concat(o.sampleName,"/").concat(o.name):o.name,r.next=21,t.artifactManager.put_file({artifact_id:n.id,file_path:i,_rkwargs:!0});case 21:return c=r.sent,r.next=24,fetch(c,{method:"PUT",body:o});case 24:if(l=r.sent,l.ok){r.next=27;break}throw new Error("Failed to upload file: ".concat(o.name));case 27:t.uploadProgress=Math.round((s+1)/t.editedFiles.length*100),t.uploadStatus="Uploaded ".concat(s+1,"/").concat(t.editedFiles.length,": ").concat(o.name);case 29:s++,r.next=12;break;case 32:t.uploadProgress=0,t.uploadStatus="Upload complete!",t.uploaded=!0,t.stepIndex=3,r.next=42;break;case 38:r.prev=38,r.t0=r["catch"](6),console.error(r.t0),alert("Failed to create or update the deposit: ".concat(r.t0.message));case 42:return r.prev=42,t.uploadProgress=0,a.close(),r.finish(42);case 46:case"end":return r.stop()}}),r,null,[[6,38,42,46]])})))()}}},Bt=Wt,Ft=(r("99d5"),Object(K["a"])(Bt,$e,Ne,!1,null,"5427f737",null)),Kt=Ft.exports,qt=r("f820"),zt={notebook:"notebook-outline",dataset:"database",application:"puzzle",model:"hubspot"};function $t(e){return e.replace(/_/g," ").replace(/(^|\s)\S/g,(function(e){return e.toUpperCase()}))}var Nt=function(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}();function Yt(){return Zt.apply(this,arguments)}function Zt(){return Zt=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),Zt.apply(this,arguments)}function Xt(e,t){if(!t.config||!t.config._linked){if(t.config=t.config||{},t.apps=t.apps||[],t.apps.unshift({name:"Share",icon:"share-variant",show_on_hover:!0,run:function(){var r=Object.assign({},e.$route.query);r.id=t.id,e.$router.replace({query:r}).catch((function(){})),e.$buefy.dialog.alert({title:"Sharing "+t.type,hasIcon:!0,icon:"share",message:"Here is the URL for sharing ".concat(t.name,": <br> <code>").concat(window.location.href,"</code>"),confirmText:"OK"})}}),t.source&&t.source.startsWith("http")&&t.apps.unshift({name:"Source",icon:"code-tags",show_on_hover:!0,run:function(){e.showSource(t)}}),t.apps.unshift({name:"Add bookmark",icon:"bookmark-plus",show_on_hover:!0,run:function(){e.$store.commit("addBookmark",t),e.showMessage(t.name+" added to the bookmarks!")}}),"application"===t.type)if(e.allApps[t.id])t.apps.unshift({name:"Run",icon:"play",run:function(){S(e,e.allApps[t.id],e.resourceItems)}});else if(t.tags.includes("colab")&&t.source.endsWith(".ipynb"))if(t.config=t.config||{},t.source.startsWith("https://raw.githubusercontent.com/")){var r=t.source.split("/");t.config._colab_url="https://colab.research.google.com/github/".concat(r[3],"/").concat(r[4],"/blob/").concat(r[5],"/").concat(r.slice(6).join("/")),t.apps.unshift({name:"Run",icon:"play",run:function(){window.open(t.config._colab_url)}})}else console.warn("Invalid colab source URL: "+t.source+" (the URL must be a raw github URL starts with https://raw.githubusercontent.com/)");if(t.links){t.links=Object(u["a"])(new Set(t.links));var a,n=Object(l["a"])(t.links);try{var s=function(){var r,n=a.value,s=e.resourceItems.filter((function(e){return e.id===n})),o=Object(l["a"])(s);try{var c=function(){var a=r.value;t.apps.unshift({name:a.name,icon:a.icon||zt[a.type],run:function(){return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!e.allApps[n]){r.next=6;break}return r.next=3,Yt(t);case 3:A(e,e.allApps[n],t),r.next=7;break;case 6:e.showResourceItemInfo(a);case 7:case"end":return r.stop()}}),r)})))()}})};for(o.s();!(r=o.n()).done;)c()}catch(fr){o.e(fr)}finally{o.f()}};for(n.s();!(a=n.n()).done;)s()}catch(fr){n.e(fr)}finally{n.f()}}t.owners&&t.owners.includes(e.userId)&&t.apps.unshift({name:"Edit",icon:"pencil",show_on_hover:!1,run:function(){e.$router.push({name:"Update",params:{updateDepositId:t.id}})}});var o,c=e.resourceItems.filter((function(e){return e.links&&e.links.includes(t.id)})),_=Object(l["a"])(c);try{for(_.s();!(o=_.n()).done;){var d=o.value;t.attachments[d.type]?t.attachments[d.type].push(d):t.attachments[d.type]=[d]}}catch(fr){_.e(fr)}finally{_.f()}t.stats&&void 0!==t.stats.downloads&&t.badges.unshift({label:"downloads",label_type:"is-dark",ext:t.stats.downloads,run:function(){e.showStatsDialog(t)}}),t.doi&&t.badges.unshift({label:t.doi,label_type:"is-dark",label_short:e.zenodoClient.isSandbox?"Zenodo":"DOI",url:e.zenodoClient.isSandbox?"https://sandbox.zenodo.org/record/".concat(t.id):"https://doi.org/".concat(t.doi)}),t.config._linked=!0}}var Vt={name:"Home",props:["resourceId"],components:{"resource-item-list":Me,"resource-item-selector":ee,"resource-item-info":ze,upload:Kt,attachments:We,markdown:Be["a"],about:qt["default"]},data:function(){return{initialized:!1,progress:100,searchTags:null,isTouchDevice:Nt,rawResourceItems:null,selectedItems:null,showMenu:!1,applications:[],dialogWindowConfig:{width:"800px",height:"670px",draggable:!0,fullscreen:!1},dialogWindows:[],selectedWindowsStack:[],selectedDialogWindow:null,selectedResourceItem:null,infoDialogFullscreen:!1,screenWidth:1e3,showInfoDialogMode:null,viewerUrl:null,infoDialogTitle:"",infoMarkdownUrl:null,infoMarkdownContent:null,infoCommentBoxTitle:null,selectedCategory:null,displayMode:"card",currentTags:[],selectedPartner:null}},mounted:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,r,a,n,s,o,i,c,u,_,d,p,f=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.eventBus.$on("showResourceItemInfo",this.showResourceItemInfo),this.resourceId=this.resourceId&&this.resourceId.toLowerCase(),window.addEventListener("resize",this.updateSize),window.dispatchEvent(new Event("resize")),t=Object(l["a"])(this.resourceCategories),e.prev=5,t.s();case 7:if((r=t.n()).done){e.next=14;break}if(a=r.value,"dataset"!==a.type){e.next=12;break}return this.selectedCategory=a,e.abrupt("break",14);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](5),t.e(e.t0);case 19:return e.prev=19,t.f(),e.finish(19);case 22:if(e.prev=22,n=new URLSearchParams(window.location.search),n.forEach((function(e,t){f.$route.query[t]=e})),s=window.location.pathname+"#"+window.location.hash.substr(1),window.history.replaceState(null,"",s),o=this.siteConfig.rdf_root_repo,i=this.$route.query.repo,c=this.siteConfig.manifest_url,!i){e.next=46;break}if(!i.startsWith("http")&&!i.startsWith("/")){e.next=35;break}c=i,e.next=45;break;case 35:if(2!==i.split("/").length){e.next=39;break}c="https://raw.githubusercontent.com/".concat(i,"/master/manifest.bioimage.io.json"),e.next=45;break;case 39:if(3!==i.split("/").length){e.next=43;break}c="https://raw.githubusercontent.com/".concat(i,"/manifest.bioimage.io.json"),e.next=45;break;case 43:throw alert("Unsupported repo format."),"Unsupported repo format.";case 45:o=i;case 46:return u=this,e.next=49,this.$store.dispatch("fetchResourceItems",{repo:o,manifest_url:c,transform:function(e){return Xt(u,e)},filter:function(e){return!!u.$route.query.migration||!!("dataset"!==e.type||e.config&&e.config._conceptdoi)}});case 49:_=this.selectedCategory&&this.selectedCategory.type,this.selectedItems=_?this.resourceItems.filter((function(e){return e.type===_})):this.resourceItems,this.resourceId&&(this.resourceId.startsWith("zenodo:")?(d=parseInt(this.resourceId.split(":")[1]),p=this.resourceItems.filter((function(e){return e.config&&e.config._deposit&&(e.config._deposit.id===d||e.config._deposit.conceptrecid===d)}))[0],p?this.$route.query.id=p.id:alert("Oops, resource item not found: "+this.resourceId+". Possibly because it has not been approved yet.")):this.$route.query.id=this.resourceId),this.updateViewByUrlQuery(),this.$forceUpdate(),e.next=60;break;case 56:e.prev=56,e.t1=e["catch"](22),console.error(e.t1),alert("Oops! Failed to fetch manifest data. Details: ".concat(e.t1,"."));case 60:case"end":return e.stop()}}),e,this,[[5,16,19,22],[22,56]])})));function t(){return e.apply(this,arguments)}return t}(),computed:Object(a["a"])({userId:function(){return this.zenodoClient&&this.zenodoClient.getUserId()},partners:function(){return this.siteConfig.partners&&this.siteConfig.partners.concat([{isJoinButton:!0,name:"Join Community Partners",icon:"/static/img/plus-sign.png"}])},resourceCategories:function(){var e=this;return this.selectedPartner?this.siteConfig.resource_categories.filter((function(t){return e.selectedPartner.resource_types.includes(t.type)})):this.siteConfig.resource_categories},tagCategories:function(){if(this.selectedCategory)return this.selectedCategory&&this.selectedCategory.tag_categories;var e,t={},r=Object(l["a"])(this.resourceCategories);try{for(r.s();!(e=r.n()).done;){var a=e.value;t=Object.assign(t,a.tag_categories)}}catch(fr){r.e(fr)}finally{r.f()}return t}},Object(c["b"])({eventBus:function(e){return e.eventBus},allApps:function(e){return e.allApps},zenodoClient:function(e){return e.zenodoClient},siteConfig:function(e){return e.siteConfig},resourceItems:function(e){return e.resourceItems}})),beforeDestroy:function(){this.eventBus.$off("showResourceItemInfo",this.showResourceItemInfo),window.removeEventListener("resize",this.updateSize)},methods:{switchToSandbox:function(){var e=Object.assign({},this.$route.query);e.sandbox=1,delete e.production,this.$router.replace({query:e}),this.$router.go(this.$router.currentRoute)},switchToProduction:function(){var e=Object.assign({},this.$route.query);e.production=1,delete e.sandbox,this.$router.replace({query:e}),this.$router.go(this.$router.currentRoute)},goHome:function(){this.selectedPartner=null,this.searchTags=[];var e=Object.assign({},this.$route.query);delete e.partner,delete e.tags,this.$router.push({query:e}).catch((function(){}))},switchPartner:function(e){var t=this;if(this.selectedPartner=e,this.selectedCategory=null,this.selectedPartner.default_type){var r,a=Object(l["a"])(this.resourceCategories);try{for(a.s();!(r=a.n()).done;){var n=r.value;if(n.type===this.selectedPartner.default_type){this.selectedCategory=n;break}}}catch(fr){a.e(fr)}finally{a.f()}}this.$nextTick((function(){t.searchTags=t.selectedPartner&&t.selectedPartner.tags}));var s=Object.assign({},this.$route.query);s.partner=e.id,s.tags=e.tags,this.initialized&&this.$router.replace({query:s}).catch((function(){}))},showStatsDialog:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.infoDialogTitle="Statistics for "+e.name,t.showInfoDialogMode="markdown",r.next=4,Yt(e);case 4:if(t.infoCommentBoxTitle=null,e.stats){for(a="",n=0,s=Object.keys(e.stats);n<s.length;n++)o=s[n],a+="\n * ".concat($t(o),": ").concat(e.stats[o]);t.infoMarkdownContent="# Statistics for ".concat(e.name)+a,t.infoMarkdownContent+="\n\n[More info on how stats are collected](https://help.zenodo.org/#statistics)"}else t.infoMarkdownContent="No stats info available.";t.screenWidth<700&&(t.infoDialogFullscreen=!0),t.$modal.show("info-dialog");case 8:case"end":return r.stop()}}),r)})))()},showAttachmentsDialog:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Yt(e);case 2:r.infoDialogTitle=t?e.name+": "+t:e.name+": Attachments",r.selectedResourceItem=e,r.selectedResourceItem._focus=t,r.showInfoDialogMode="attachments",r.screenWidth<700&&(r.infoDialogFullscreen=!0),r.$modal.show("info-dialog");case 8:case"end":return a.stop()}}),a)})))()},removePartner:function(){this.selectedPartner&&(this.selectedPartner=null,this.updateQueryTags(this.searchTags))},updateQueryTags:function(e){if(this.initialized){this.searchTags=e,e&&(e.length>0?this.currentTags=e:this.currentTags=null);var t=Object.assign({},this.$route.query);this.selectedCategory?"model"===this.selectedCategory.type&&Object.keys(t).length<=1?delete t.type:t.type=this.selectedCategory.type:t.type="all",this.currentTags?t.tags=this.currentTags.join(","):delete t.tags,this.selectedPartner?this.selectedPartner.tags&&JSON.stringify(this.selectedPartner.tags)==JSON.stringify(this.currentTags)&&delete t.tags:delete t.partner,this.$router.replace({query:t}).catch((function(){}))}},displayModeChanged:function(e){this.displayMode=e},addWindow:function(e){this.selectedDialogWindow&&this.selectedWindowsStack.push(this.selectedDialogWindow),this.selectWindow(e),this.dialogWindows.push(e),this.screenWidth<700&&(this.dialogWindowConfig.fullscreen=!0),this.$modal.show("window-modal-dialog"),this.$forceUpdate()},selectWindow:function(e){e.closing||(this.selectedDialogWindow=e)},updateSize:function(){var e=this;Object(_["d"])((function(){e.screenWidth=window.innerWidth,e.screenWidth<700&&(e.infoDialogFullscreen=!0),e.$forceUpdate()}),250)()},showLoader:function(e,t){e?this.loadingComponent=this.$buefy.loading.open({canCancel:!0,onCancel:function(){t&&t()}}):this.loadingComponent&&(this.loadingComponent.close(),this.loadingComponent=null)},showAboutDialog:function(){this.showInfoDialogMode="about",this.infoDialogTitle="About",this.screenWidth<700&&(this.infoDialogFullscreen=!0),this.$modal.show("info-dialog");var e=Object.assign({},this.$route.query);e.show="about",this.initialized&&this.$router.replace({query:e}).catch((function(){}))},showUploadDialog:function(){this.infoDialogTitle="Uploading data to ".concat(this.siteConfig.site_name),this.showInfoDialogMode="upload",this.currentDepositionId=null,this.screenWidth<700&&(this.infoDialogFullscreen=!0),this.$modal.show("info-dialog");var e=Object.assign({},this.$route.query);e.show="upload",this.initialized&&this.$router.replace({query:e}).catch((function(){}))},showEditDialog:function(){this.infoDialogTitle="Updating metadata",this.showInfoDialogMode="edit",this.screenWidth<700&&(this.infoDialogFullscreen=!0),this.$modal.show("info-dialog");var e=Object.assign({},this.$route.query);e.show="edit",this.initialized&&this.$router.replace({query:e}).catch((function(){}))},showAboutPartner:function(e){e.about_url.startsWith("http")?e.about_url.endsWith(".md")?(this.infoDialogTitle="About "+e.name,this.infoMarkdownUrl=e.about_url,this.showInfoDialogMode="markdown",this.screenWidth<700&&(this.infoDialogFullscreen=!0),this.$modal.show("info-dialog")):window.open(e.about_url):e.description?this.$buefy.dialog.alert({title:"About "+e.name,message:e.description,confirmText:"OK"}):this.$buefy.dialog.alert({title:"Oops, no details about "+e.name,message:"This partner is did not provide any details!",confirmText:"OK"})},showSource:function(e){e.source.endsWith(".yaml")||e.source.endsWith(".yml")||e.source.endsWith(".imjoy.html")?(this.infoDialogTitle="Source: "+e.name,this.infoMarkdownUrl=e.source,this.infoCommentBoxTitle=e.name,this.showInfoDialogMode="markdown",this.screenWidth<700&&(this.infoDialogFullscreen=!0),this.$modal.show("info-dialog"),this.$forceUpdate()):e.source.startsWith("http")?window.open(e.source):this.$buefy.dialog.alert({title:"Source: "+e.name,hasIcon:!0,icon:"code-tags",message:e.source,confirmText:"OK"})},showResourceItemInfo:function(e,t){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r.$router.push({name:"ResourceItemInfo",params:{resourceId:e.id}}),a.next=3,Yt(e);case 3:r.showInfoDialogMode="item",e._focus=t,r.selectedResourceItem=e,r.infoDialogTitle=r.selectedResourceItem.name,r.infoDialogFullscreen=!1,r.$modal.show("info-dialog"),e.id&&!window.location.href.includes("#/r/")&&(n=Object.assign({},r.$route.query),n.id=e.id,r.$router.replace({query:n}).catch((function(){})));case 10:case"end":return a.stop()}}),a)})))()},updateStatus:function(e){!0===e.loading&&this.showMessage("Loading..."),!1===e.loading&&this.showMessage("Loading done.")},closeInfoWindow:function(){this.selectedResourceItem=null,this.showInfoDialogMode=null,this.infoMarkdownUrl=null,this.infoMarkdownContent=null,this.infoCommentBoxTitle=null,this.$modal.hide("info-dialog");var e=Object.assign({},this.$route.query);delete e.id,delete e.show,this.$router.replace({query:e}).catch((function(){}))},maximizeInfoWindow:function(){this.infoDialogFullscreen=!this.infoDialogFullscreen},closeDialogWindow:function(e){if(this.selectedDialogWindow.id===e.id){var t=this.dialogWindows.indexOf(e);t>=0&&this.dialogWindows.splice(t,1),this.selectedDialogWindow=this.selectedWindowsStack.pop(),this.selectedDialogWindow||this.$modal.hide("window-modal-dialog")}else console.warn("ignore close window: "+e.id)},minimizeDialogWindow:function(){this.$modal.hide("window-modal-dialog")},maximizeDialogWindow:function(){this.dialogWindowConfig.fullscreen=!this.dialogWindowConfig.fullscreen},enter:function(){var e=window.pageYOffset+this.$refs.search_anchor.getBoundingClientRect().top;window.scrollTo({top:e-100,behavior:"smooth",block:"start"})},updateResourceItemList:function(e){this.selectedItems=e},updateViewByUrlQuery:function(){var e=this,t=!1;if(this.$route.query.show&&("about"===this.$route.query.show?this.showAboutDialog():"upload"===this.$route.query.show&&this.showUploadDialog()),this.$route.query.id){var r=this.resourceItems.filter((function(t){return t.id===e.$route.query.id}))[0];r?(this.showResourceItemInfo(r),t=!0):alert("Oops, resource item not found: "+this.$route.query.id+". Possibly because it has not been approved yet.")}if(this.$route.query.tags){var a=null;a="string"===typeof this.$route.query.tags?this.$route.query.tags.split(","):this.$route.query.tags,setTimeout((function(){e.searchTags=a}),0),t=!0}this.$route.query.type&&("all"===this.$route.query.type?this.selectedCategory=null:this.selectedCategory=this.resourceCategories.filter((function(t){return t.type===e.$route.query.type}))[0],t=!0),this.$route.query.partner&&this.siteConfig.partners&&(this.selectedPartner=this.siteConfig.partners.filter((function(t){return t.id===e.$route.query.partner}))[0],this.selectedPartner&&(this.$nextTick((function(){e.searchTags?e.searchTags=e.searchTags.concat(e.selectedPartner.tags):e.searchTags=e.selectedPartner.tags})),t=!1)),t&&this.enter(),this.initialized=!0},showProgress:function(e){this.progress=e,this.$forceUpdate()},showMessage:function(e,t){t=t||5e3;var r={message:e.slice(0,200),onAction:function(){},actionText:"Close",duration:t,queue:!1};this.$buefy.snackbar.open(r)},showWindowDialog:function(){},closeWindowDialog:function(){},getLabelCount:function(e){return this.filteredModels.filter((function(t){return t.allLabels.includes(e)})).length},getModelsCount:function(){return this.filteredModels.length}}},Jt=Vt,Ht=(r("cccb"),Object(K["a"])(Jt,Z,X,!1,null,null,null)),Gt=Ht.exports,Qt=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"viewer"},[r("section",{staticClass:"width-limited"},[!e.value||e.value.length<=0?r("h1",{staticStyle:{"text-align":"center",color:"white","font-size":"2rem","margin-top":"20px"}},[e._v(" SMLM File Viewer ")]):e._e(),!e.value||e.value.length<=0?r("b-field",{staticStyle:{"margin-top":"20px","margin-left":"20px","margin-right":"20px"}},[r("b-upload",{attrs:{multiple:"","drag-drop":"",expanded:""},on:{input:function(t){return e.updateFiles(t)}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[r("section",{staticClass:"section"},[r("div",{staticClass:"content has-text-centered"},[r("b-icon",{attrs:{icon:"upload",size:"is-large"}}),r("p",[e._v("Drag and drop files here")]),r("p",[e._v(" Your data will stay locally in your browser, no data will be sent or uploaded to the server. ")]),r("p",[e._v(" For multi-channel image, drag the files for all the channels together. ")])],1)])])],1):e._e()],1),!e.value||e.value.length<=0?r("div",{staticClass:"width-limited",staticStyle:{margin:"20px",padding:"20px"}},[r("br"),e._m(0),e._m(1)]):e._e(),!e.value||e.value.length<=0?e._l(e.value,(function(t,a){return r("div",{key:a,staticClass:"tag is-primary",staticStyle:{cursor:"pointer"},attrs:{id:e.containerId+"-files"},on:{click:function(r){return e.previewFile([t])}}},[e._v(" "+e._s(t.name.slice(0,20)+(t.name.length>20?"...":""))+" "),r("button",{staticClass:"delete is-small",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.removeFile(a)}}})])})):e._e(),r("div",{staticClass:"viewer-container",attrs:{id:e.containerId}})],2)},er=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v(" You can load files with the following formats: "),r("a",{attrs:{href:"https://github.com/imodpasteur/smlm-file-format",target:"_blank"}},[e._v("SMLM(.smlm)")]),e._v(", ThunderSTORM(.csv/.xls), RapidSTROM, ZEISS(ELYRA), Nikon NSTORM(txt). ")])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("p",[e._v(" If you have other file format which is not supported yet, please "),r("a",{attrs:{href:"https://www.dropbox.com/request/IyZ7HkzHUpB0t5Mkp46l",target:"_blank"}},[e._v("upload a sample file")]),e._v(", and "),r("a",{attrs:{href:"https://oeway.typeform.com/to/rdkPmd",target:"_blank"}},[e._v("send us a message")]),e._v(" to describe your file format, we will try to support your file format. ")])}],tr={name:"viewer",props:["resourceId"],data:function(){return{containerId:"preview-container-"+Math.random().toString(36).substr(2,9),viewer:null,value:void 0,fileCache:{},currentFiles:null}},mounted:function(){this.init()},computed:Object(a["a"])({},Object(c["b"])({imjoyReady:function(e){return e.imjoyReady},imjoy:function(e){return e.imjoy},siteConfig:function(e){return e.siteConfig},loadedUrl:function(e){return e.loadedUrl},resourceItems:function(e){return e.resourceItems}})),created:function(){this.resourceId=this.resourceId&&this.resourceId.toLowerCase(),this.value=[],this.views=[],this.commitValue()},methods:{commitValue:function(){this.value.views=this.views,this.$emit("input",this.value)},capture:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.viewer.captureImage();case 2:return r=t.sent,t.next=5,e.viewer.getViewConfig();case 5:a=t.sent,a["_file"]=e.currentFiles&&e.currentFiles.map((function(e){return e.name})),e.views.filter((function(e){return e.image===r})).length<=0?e.views.push({config:a,image:r}):e.imjoy.api.showMessage("Please change the image to another view and try again."),e.commitValue();case 9:case"end":return t.stop()}}),t)})))()},removeFile:function(e){var t=this.value[e];this.currentFiles.includes(t)&&(this.currentFile=null),this.value.splice(e,1),this.$forceUpdate()},updateFiles:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,t.previewFile(e);case 3:r.next=11;break;case 5:return r.prev=5,r.t0=r["catch"](0),r.next=9,t.imjoy.api.showMessage("Failed to preview file: ".concat(r.t0));case 9:t.value=[],console.error(r.t0);case 11:t.commitValue();case 12:case"end":return r.stop()}}),r,null,[[0,5]])})))()},trimEllip:function(e,t){return e?("object"===Object(Te["a"])(e)&&(e=e.toString()),e.length>t?e.substring(0,t)+"...":e):e},previewFile:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i,c,u,d,p,f,h,m,g,b;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:a=t.imjoy.api,n=t.$buefy.loading.open({container:s}),s=document.getElementById(t.containerId),o=Object(l["a"])(e),r.prev=4,o.s();case 6:if((i=o.n()).done){r.next=28;break}if(c=i.value,"remote"!==c.type){r.next=26;break}if(r.prev=9,t.fileCache[c.url]){r.next=18;break}return r.next=13,Object(_["f"])(c.url,c.name,t.imjoy&&t.imjoy.api.showMessage);case 13:u=r.sent,c=u,t.fileCache[c.url]=c,r.next=19;break;case 18:c=t.fileCache[c.url];case 19:r.next=26;break;case 21:return r.prev=21,r.t0=r["catch"](9),console.error(r.t0),alert("Failed to fetch file from ".concat(c.url,": ").concat(r.t0)),r.abrupt("return");case 26:r.next=6;break;case 28:r.next=33;break;case 30:r.prev=30,r.t1=r["catch"](4),o.e(r.t1);case 33:return r.prev=33,o.f(),r.finish(33);case 36:return t.currentFiles=e,d=[],r.next=40,a.getPlugin("SMLM File IO");case 40:p=r.sent,f=Object(l["a"])(e),r.prev=42,f.s();case 44:if((h=f.n()).done){r.next=63;break}return m=h.value,r.prev=46,r.next=49,p.load(m);case 49:g=r.sent,d=d.concat(g.files),s.style.height="calc( 100vh - 72px)",r.next=58;break;case 54:throw r.prev=54,r.t2=r["catch"](46),console.error(r.t2),r.t2;case 58:return r.prev=58,n.close(),r.finish(58);case 61:r.next=44;break;case 63:r.next=68;break;case 65:r.prev=65,r.t3=r["catch"](42),f.e(r.t3);case 68:return r.prev=68,f.f(),r.finish(68);case 71:return b=window.location.origin+window.location.pathname,r.next=74,a.createWindow({name:"Fairy Dust",src:b+"FairyDust.imjoy.html",window_id:t.containerId,data:d});case 74:t.viewer=r.sent;case 75:case"end":return r.stop()}}),r,null,[[4,30,33,36],[9,21],[42,65,68,71],[46,54,58,61]])})))()},init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var r,a,n,s,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.$buefy.loading.open(),e.resourceId){t.next=4;break}return e.imjoyReady.then((function(e){var t=e.api,r=window.location.origin+window.location.pathname;t.getPlugin(r+"SMLM-File-IO.imjoy.html")})).finally((function(){r.close()})),t.abrupt("return");case 4:if(e.loadedUrl){t.next=9;break}return a=e.siteConfig.rdf_root_repo,n=e.siteConfig.manifest_url,t.next=9,e.$store.dispatch("fetchResourceItems",{repo:a,manifest_url:n});case 9:if(s=e.resourceItems.filter((function(t){return t.id===e.resourceId}))[0],s){t.next=13;break}return alert("Item not found: "+e.resourceId),t.abrupt("return");case 13:if(!s.download_url){t.next=32;break}return t.prev=14,t.next=17,Object(_["f"])(s.download_url,s.name,e.imjoy&&e.imjoy.api.showMessage);case 17:return o=t.sent,c=e.imjoy.api,l=window.location.origin+window.location.pathname,t.next=22,c.getPlugin(l+"SMLM-File-IO.imjoy.html").then(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.previewFile([o]);case 2:case"end":return t.stop()}}),t)}))));case 22:t.next=29;break;case 24:throw t.prev=24,t.t0=t["catch"](14),alert("Failed to download file: "+s.download_url),console.error(t.t0),t.t0;case 29:return t.prev=29,r.close(),t.finish(29);case 32:console.log(s);case 33:case"end":return t.stop()}}),t,null,[[14,24,29,32]])})))()}}},rr=tr,ar=(r("f409"),Object(K["a"])(rr,Qt,er,!1,null,"6adda98c",null)),nr=ar.exports;n["default"].use(Y["a"]);var sr=[{path:"/",name:"Home",component:Gt},{path:"/r/:resourceId+",name:"ResourceItemInfo",component:Gt,props:!0},{path:"/upload",name:"Upload",component:Kt},{path:"/update/:updateDepositId+",name:"Update",component:Kt,props:!0},{path:"/viewer",name:"Viewer",component:nr},{path:"/app",name:"App",component:Me},{path:"/about",name:"About",component:function(){return Promise.resolve().then(r.bind(null,"f820"))}}],or=new Y["a"]({base:"/",routes:sr}),ir=or,cr=r("289d"),lr=(r("6a05"),r("f935"),r("1881")),ur=r.n(lr),_r=(r("5363"),r("7bb1")),dr=r("4c93"),pr=r("2593");n["default"].component("ValidationProvider",_r["a"]),Object.keys(dr).forEach((function(e){Object(_r["b"])(e,Object(a["a"])(Object(a["a"])({},dr[e]),{},{message:pr["a"][e]}))})),n["default"].use(ur.a),n["default"].use(cr["a"]),n["default"].config.productionTip=!1,new n["default"]({router:ir,render:function(e){return e(z)},store:j,created:function(){D()}}).$mount("#app")},"5ced":function(e,t,r){},"68ea":function(e,t,r){"use strict";var a=r("cff3"),n=r.n(a);n.a},"6a05":function(e,t,r){},"85ec":function(e,t,r){},9224:function(e){e.exports=JSON.parse('{"a":"0.4.8"}')},"944d":function(e,t,r){},"968b":function(e,t,r){"use strict";var a=r("4a91"),n=r.n(a);n.a},"970a":function(e,t,r){"use strict";var a=r("478a"),n=r.n(a);n.a},"982c":function(e,t,r){},"99d5":function(e,t,r){"use strict";var a=r("f6b2"),n=r.n(a);n.a},ac16:function(e,t,r){},b35e:function(e,t,r){"use strict";var a=r("299b"),n=r.n(a);n.a},cccb:function(e,t,r){"use strict";var a=r("5ced"),n=r.n(a);n.a},cff3:function(e,t,r){},d479:function(e,t,r){"use strict";var a=r("50cf"),n=r.n(a);n.a},e067:function(e,t,r){"use strict";var a=r("4871"),n=r.n(a);n.a},e5dd:function(e,t,r){},e6e0:function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"markdown-body"},[r("b-loading",{attrs:{"is-full-page":!1,active:e.loading,"can-cancel":!1},on:{"update:active":function(t){e.loading=t}}}),e.docs?r("div",{domProps:{innerHTML:e._s(e.docs)}}):e._e()],1)},n=[],s=(r("a15b"),r("fb6a"),r("d3b7"),r("ac1f"),r("8a79"),r("5319"),r("1276"),r("9911"),r("96cf"),r("1da1")),o=(r("e4cb"),r("2c43"),r("0e54")),i=r.n(o),c=r("c0c4"),l=r.n(c),u=r("1487"),_=r.n(u),d=r("025e"),p={name:"Markdown",props:{baseUrl:{type:String,default:""},content:{type:String,default:null},url:{type:String,default:null}},data:function(){return{docs:null,loading:!1}},created:function(){var e=new i.a.Renderer;e.link=function(e,t,r){var a=i.a.Renderer.prototype.link.call(this,e,t,r);return a.replace("<a","<a target='_blank' ")},e.image=function(e,t,r){var a=i.a.Renderer.prototype.image.call(this,e,t,r);return a.replace("/./","/")},i.a.setOptions({renderer:e,highlight:function(e){return _.a.highlightAuto(e).value}}),l.a.addHook("afterSanitizeAttributes",(function(e){"target"in e&&(e.setAttribute("target","_blank"),e.setAttribute("rel","noopener noreferrer"))}))},watch:{content:function(e){this.docs=l.a.sanitize(Object(d["i"])(i()(e),this.baseUrl)),this.loading=!1},baseUrl:function(e){this.baseUrl=e,this.docs=l.a.sanitize(Object(d["i"])(i()(this.content),this.baseUrl))},url:function(e){e&&this.showDocsUrl(e)}},mounted:function(){i.a.setOptions({baseUrl:this.baseUrl}),this.content?this.docs=l.a.sanitize(Object(d["i"])(i()(this.content),this.baseUrl)):this.url&&this.showDocsUrl(this.url)},methods:{showDocsUrl:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.loading=!0,t.docs="@loading...",r.prev=2,r.next=5,fetch(e);case 5:if(a=r.sent,200!=a.status){r.next=13;break}return r.next=9,a.text();case 9:n=r.sent,e.endsWith(".md")?(s=e.split("/"),o=s.slice(0,s.length-1).join("/"),t.docs=l.a.sanitize(Object(d["i"])(i()(n),o)),t.loading=!1):t.docs=l.a.sanitize(i()("```\n"+n+"\n```\n")),r.next=14;break;case 13:t.docs="Oops! Failed to load from "+e;case 14:r.next=19;break;case 16:r.prev=16,r.t0=r["catch"](2),t.docs="Oops! Failed to load from "+e;case 19:return r.prev=19,t.loading=!1,r.finish(19);case 22:case"end":return r.stop()}}),r,null,[[2,16,19,22]])})))()}}},f=p,h=r("2877"),m=Object(h["a"])(f,a,n,!1,null,"3dae94c1",null);t["a"]=m.exports},f2bc:function(e,t,r){},f409:function(e,t,r){"use strict";var a=r("e5dd"),n=r.n(a);n.a},f6b2:function(e,t,r){},f820:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"about",style:{"background-image":"url("+e.siteConfig.background_image+")"}},[r("p",{staticClass:"version-number"},[e._v("v"+e._s(e.version))]),r("section",{staticClass:"hero"},[r("markdown",{attrs:{url:"https://raw.githubusercontent.com/imodpasteur/ShareLoc.XYZ/main/README.md"}})],1),r("br"),e.siteConfig.footer?r("div",{staticClass:"columns is-mobile is-centered"},e._l(e.siteConfig.footer,(function(t){return r("div",{key:t.label,staticClass:"column is-one-quarter",staticStyle:{"text-align":"center"}},[r("b-tooltip",{attrs:{label:t.tooltip,position:"is-top"}},[r("a",{attrs:{href:t.url,target:"_blank"}},[r("figure",[r("img",{staticStyle:{"max-height":"55px"},attrs:{src:t.logo}}),r("figcaption",{staticClass:"hide-on-small-screen"},[e._v(" "+e._s(t.label)+" ")])])])])],1)})),0):e._e(),e.siteConfig.footnote?r("div",{staticStyle:{"text-align":"center"}},[r("p",[e._v(e._s(e.siteConfig.footnote))])]):e._e()])},n=[],s=r("5530"),o=r("2f62"),i=r("9224"),c=r("e6e0"),l={name:"About",components:{markdown:c["a"]},computed:Object(s["a"])({},Object(o["b"])({siteConfig:function(e){return e.siteConfig}})),data:function(){return{version:i["a"]}}},u=l,_=(r("68ea"),r("2877")),d=Object(_["a"])(u,a,n,!1,null,"72e02d3c",null);t["default"]=d.exports},f935:function(e,t,r){},f9e7:function(e,t,r){"use strict";var a=r("982c"),n=r.n(a);n.a},fff7:function(e,t,r){"use strict";var a=r("560e"),n=r.n(a);n.a}});
//# sourceMappingURL=app.56bcf201.js.map